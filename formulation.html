<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Formulations &#8212; Phonopy v.1.12.3</title>
    <link rel="stylesheet" href="_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '1.12.3',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="_static/bootstrap-3.3.7/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="_static/bootstrap-sphinx.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="How to cite phonopy" href="citation.html" />
    <link rel="prev" title="Using phonopy as a python module" href="phonopy-module.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">

  </head>
  <body>

  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="index.html">
          Phonopy</a>
        <span class="navbar-text navbar-version pull-left"><b>1.12.3</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="index.html">Site <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><ul class="current">
<li class="toctree-l1"><a class="reference internal" href="install.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="symmetry.html">Crystal symmetry</a></li>
<li class="toctree-l1"><a class="reference internal" href="procedure.html">Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="workflow.html">Work flow</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples.html">Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="input-files.html">Input files</a></li>
<li class="toctree-l1"><a class="reference internal" href="output-files.html">Output files</a></li>
<li class="toctree-l1"><a class="reference internal" href="setting-tags.html">Setting tags</a></li>
<li class="toctree-l1"><a class="reference internal" href="command-options.html">Command options</a></li>
<li class="toctree-l1"><a class="reference internal" href="qha.html">Quasi harmonic approximation</a></li>
<li class="toctree-l1"><a class="reference internal" href="gruneisen.html">Mode Grüneisen parameters</a></li>
<li class="toctree-l1"><a class="reference internal" href="interfaces.html">Interfaces to calculators</a></li>
<li class="toctree-l1"><a class="reference internal" href="auxiliary-tools.html">Auxiliary tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="external-tools.html">External tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="phonopy-module.html">Using phonopy as a python module</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Formulations</a></li>
<li class="toctree-l1"><a class="reference internal" href="citation.html">How to cite phonopy</a></li>
<li class="toctree-l1"><a class="reference internal" href="reference.html">References</a></li>
<li class="toctree-l1"><a class="reference internal" href="changelog.html">Change Log</a></li>
</ul>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="documentation.html">Documentation</a></li>
</ul>
</ul>
</li>
              
                <li class="dropdown">
  <a role="button"
     id="dLabelLocalToc"
     data-toggle="dropdown"
     data-target="#"
     href="#">Page <b class="caret"></b></a>
  <ul class="dropdown-menu localtoc"
      role="menu"
      aria-labelledby="dLabelLocalToc"><ul>
<li><a class="reference internal" href="#">Formulations</a><ul>
<li><a class="reference internal" href="#second-order-force-constants">Second-order force constants</a></li>
<li><a class="reference internal" href="#modified-parlinski-li-kawazoe-method">Modified Parlinski-Li-Kawazoe method</a></li>
<li><a class="reference internal" href="#dynamical-matrix">Dynamical matrix</a></li>
<li><a class="reference internal" href="#non-analytical-term-correction">Non-analytical term correction</a></li>
<li><a class="reference internal" href="#thermodynamic-properties">Thermodynamic properties</a><ul>
<li><a class="reference internal" href="#phonon-number">Phonon number</a></li>
<li><a class="reference internal" href="#harmonic-phonon-energy">Harmonic phonon energy</a></li>
<li><a class="reference internal" href="#constant-volume-heat-capacity">Constant volume heat capacity</a></li>
<li><a class="reference internal" href="#partition-function">Partition function</a></li>
<li><a class="reference internal" href="#helmholtz-free-energy">Helmholtz free energy</a></li>
<li><a class="reference internal" href="#entropy">Entropy</a></li>
</ul>
</li>
<li><a class="reference internal" href="#thermal-displacement">Thermal displacement</a><ul>
<li><a class="reference internal" href="#mean-square-displacement">Mean square displacement</a></li>
<li><a class="reference internal" href="#mean-square-displacement-matrix">Mean square displacement matrix</a></li>
<li><a class="reference internal" href="#projection-to-an-arbitrary-axis-from-the-cartesian-axes">Projection to an arbitrary axis from the Cartesian axes</a></li>
<li><a class="reference internal" href="#mean-square-displacement-matrix-in-cif-format">Mean square displacement matrix in cif format</a></li>
</ul>
</li>
<li><a class="reference internal" href="#group-velocity">Group velocity</a><ul>
<li><a class="reference internal" href="#method">Method</a></li>
<li><a class="reference internal" href="#finite-difference-method">Finite difference method</a></li>
</ul>
</li>
<li><a class="reference internal" href="#physical-unit-conversion">Physical unit conversion</a></li>
<li><a class="reference internal" href="#crystal-structure">Crystal structure</a><ul>
<li><a class="reference internal" href="#coordinates-in-direct-and-reciprocal-spaces">Coordinates in direct and reciprocal spaces</a></li>
<li><a class="reference internal" href="#commensurate-points">Commensurate points</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</ul>
</li>
              
            
            
              
                
  <li>
    <a href="phonopy-module.html" title="Previous Chapter: Using phonopy as a python module"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm hidden-tablet">&laquo; Using phonopy...</span>
    </a>
  </li>
  <li>
    <a href="citation.html" title="Next Chapter: How to cite phonopy"><span class="glyphicon glyphicon-chevron-right visible-sm"></span><span class="hidden-sm hidden-tablet">How to cite phonopy &raquo;</span>
    </a>
  </li>
              
            
            
            
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="col-md-12 content">
      
  <div class="section" id="formulations">
<span id="id1"></span><h1>Formulations<a class="headerlink" href="#formulations" title="Permalink to this headline">¶</a></h1>
<div class="contents local topic" id="contents">
<ul class="simple">
<li><a class="reference internal" href="#second-order-force-constants" id="id5">Second-order force constants</a></li>
<li><a class="reference internal" href="#modified-parlinski-li-kawazoe-method" id="id6">Modified Parlinski-Li-Kawazoe method</a></li>
<li><a class="reference internal" href="#dynamical-matrix" id="id7">Dynamical matrix</a></li>
<li><a class="reference internal" href="#non-analytical-term-correction" id="id8">Non-analytical term correction</a></li>
<li><a class="reference internal" href="#thermodynamic-properties" id="id9">Thermodynamic properties</a><ul>
<li><a class="reference internal" href="#phonon-number" id="id10">Phonon number</a></li>
<li><a class="reference internal" href="#harmonic-phonon-energy" id="id11">Harmonic phonon energy</a></li>
<li><a class="reference internal" href="#constant-volume-heat-capacity" id="id12">Constant volume heat capacity</a></li>
<li><a class="reference internal" href="#partition-function" id="id13">Partition function</a></li>
<li><a class="reference internal" href="#helmholtz-free-energy" id="id14">Helmholtz free energy</a></li>
<li><a class="reference internal" href="#entropy" id="id15">Entropy</a></li>
</ul>
</li>
<li><a class="reference internal" href="#thermal-displacement" id="id16">Thermal displacement</a><ul>
<li><a class="reference internal" href="#mean-square-displacement" id="id17">Mean square displacement</a></li>
<li><a class="reference internal" href="#mean-square-displacement-matrix" id="id18">Mean square displacement matrix</a></li>
<li><a class="reference internal" href="#projection-to-an-arbitrary-axis-from-the-cartesian-axes" id="id19">Projection to an arbitrary axis from the Cartesian axes</a></li>
<li><a class="reference internal" href="#mean-square-displacement-matrix-in-cif-format" id="id20">Mean square displacement matrix in cif format</a></li>
</ul>
</li>
<li><a class="reference internal" href="#group-velocity" id="id21">Group velocity</a><ul>
<li><a class="reference internal" href="#method" id="id22">Method</a></li>
<li><a class="reference internal" href="#finite-difference-method" id="id23">Finite difference method</a></li>
</ul>
</li>
<li><a class="reference internal" href="#physical-unit-conversion" id="id24">Physical unit conversion</a></li>
<li><a class="reference internal" href="#crystal-structure" id="id25">Crystal structure</a><ul>
<li><a class="reference internal" href="#coordinates-in-direct-and-reciprocal-spaces" id="id26">Coordinates in direct and reciprocal spaces</a></li>
<li><a class="reference internal" href="#commensurate-points" id="id27">Commensurate points</a></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="second-order-force-constants">
<h2><a class="toc-backref" href="#id5">Second-order force constants</a><a class="headerlink" href="#second-order-force-constants" title="Permalink to this headline">¶</a></h2>
<p>Potential energy of phonon system is represented as functions of atomic
positions:</p>
<div class="math">
\[V[\mathbf{r}(j_1 l_1),\ldots,\mathbf{r}(j_n l_N)],\]</div>
<p>where <span class="math">\(\mathbf{r}(jl)\)</span> is the point of the <span class="math">\(j\)</span>-th atom in
the <span class="math">\(l\)</span>-th unit cell and <span class="math">\(n\)</span> and <span class="math">\(N\)</span> are the number
of atoms in a unit cell and the number of unit cells, respectively.  A
force and a second-order force constant <span class="math">\(\Phi_{\alpha \beta}\)</span>
are given by</p>
<div class="math">
\[F_\alpha(jl) = -\frac{\partial V }{\partial r_\alpha(jl)}\]</div>
<p>and</p>
<div class="math">
\[\Phi_{\alpha\beta}(jl, j'l') = \frac{\partial^2
V}{\partial r_\alpha(jl) \partial r_\beta(j'l')} =
-\frac{\partial F_\beta(j'l')}{\partial r_\alpha(jl)},\]</div>
<p>respectively, where <span class="math">\(\alpha\)</span>, <span class="math">\(\beta\)</span>, …, are the
Cartesian indices, <span class="math">\(j\)</span>, <span class="math">\(j'\)</span>, …, are the indices of
atoms in a unit cell, and <span class="math">\(l\)</span>, <span class="math">\(l'\)</span>, …, are
the indices of unit cells. In the finite displacement method, the
equation for the force constants is approximated as</p>
<div class="math">
\[\Phi_{\alpha\beta}(jl, j'l') \simeq -\frac{
F_\beta(j'l';\Delta r_\alpha{(jl)}) - F_\beta(j'l')} {\Delta
r_\alpha(jl)},\]</div>
<p>where <span class="math">\(F_\beta(j'l'; \Delta r_\alpha{(jl)})\)</span> are the forces on
atoms with a finite displacement <span class="math">\(\Delta r_\alpha{(jl)}\)</span> and
usually <span class="math">\(F_\beta(j'l') \equiv 0\)</span>.</p>
</div>
<div class="section" id="modified-parlinski-li-kawazoe-method">
<span id="force-constants-solver-theory"></span><h2><a class="toc-backref" href="#id6">Modified Parlinski-Li-Kawazoe method</a><a class="headerlink" href="#modified-parlinski-li-kawazoe-method" title="Permalink to this headline">¶</a></h2>
<p>The following is a modified and simplified version of the
Parlinski-Li-Kawazoe method, which is just a numerical fitting
approach to obtain force constants from forces and displacements.</p>
<p>The last equation above is represented by matrices as</p>
<div class="math">
\[\mathbf{F} = - \mathbf{U} \mathbf{P},\]</div>
<p>where <span class="math">\(\mathbf{F}\)</span>, <span class="math">\(\mathbf{P}\)</span>, and <span class="math">\(\mathbf{U}\)</span>
for a pair of atoms, e.g. <span class="math">\(\{jl, j'l'\}\)</span>, are given by</p>
<div class="math">
\[\mathbf{F} =
 \begin{pmatrix}
  F_{x} &amp; F_{y} &amp; F_{z}
 \end{pmatrix},\]</div>
<div class="math">
\[\begin{split}\mathbf{P} =
  \begin{pmatrix}
  \Phi_{xx} &amp; \Phi_{xy} &amp; \Phi_{xz} \\
  \Phi_{yx} &amp; \Phi_{yy} &amp; \Phi_{yz} \\
  \Phi_{zx} &amp; \Phi_{zy} &amp; \Phi_{zz}
\end{pmatrix},\end{split}\]</div>
<div class="math">
\[\begin{split}\mathbf{U} =
 \begin{pmatrix}
   \Delta r_{x} &amp; \Delta r_{y} &amp; \Delta r_{z} \\
 \end{pmatrix}.\end{split}\]</div>
<p>The matrix equation is expanded for number of
forces and displacements as follows:</p>
<div class="math">
\[\begin{split}\begin{pmatrix}
\mathbf{F}_1 \\
\mathbf{F}_2 \\
 \vdots
\end{pmatrix}
= -
\begin{pmatrix}
\mathbf{U}_1 \\
\mathbf{U}_2 \\
 \vdots
\end{pmatrix}
\mathbf{P}.\end{split}\]</div>
<p>With sufficient number of atomic displacements, this
may be solved by pseudo inverse such as</p>
<div class="math">
\[\begin{split}\mathbf{P} = -
\begin{pmatrix}
\mathbf{U}_1 \\
\mathbf{U}_2 \\
 \vdots
\end{pmatrix}^{+}
\begin{pmatrix}
\mathbf{F}_1 \\
\mathbf{F}_2 \\
\vdots
\end{pmatrix}.\end{split}\]</div>
<p>Required number of atomic displacements to solve the simultaneous
equations may be reduced using site-point symmetries. The matrix
equation can be written using a symmetry operation as</p>
<div class="math">
\[\hat{R}(\mathbf{F}) = -\hat{R}(\mathbf{U})\mathbf{P},\]</div>
<p>where <span class="math">\(\hat{R}\)</span> is the site symmetry
operation centring at
<span class="math">\(\mathbf{r}(jl)\)</span>. <span class="math">\(\hat{R}(\mathbf{F})\)</span> and <span class="math">\(\hat{R}(\mathbf{U})\)</span> are defined as
<span class="math">\(\mathbf{RF}(\hat{R^{-1}}(j'l'))\)</span> and <span class="math">\(\mathbf{RU}\)</span>,
respectively, where <span class="math">\(\mathbf{R}\)</span> is the matrix
representation of the rotation operation. The combined
simultaneous equations are built such as</p>
<div class="math">
\[\begin{split}\begin{pmatrix}
\mathbf{F}^{(1)}_1 \\
\mathbf{F}^{(2)}_1 \\
\vdots \\
\mathbf{F}^{(1)}_2 \\
\mathbf{F}^{(2)}_2 \\
\vdots \end{pmatrix} = -
\begin{pmatrix}
\mathbf{U}^{(1)}_1 \\
\vdots \\
\mathbf{U}^{(2)}_1 \\
\mathbf{U}^{(1)}_2 \\
\mathbf{U}^{(2)}_2 \\
\vdots
\end{pmatrix}
\mathbf{P}.\end{split}\]</div>
<p>where the superscript with parenthesis gives the index of
site-symmetry operations. This is solved by pseudo inverse.</p>
</div>
<div class="section" id="dynamical-matrix">
<span id="dynacmial-matrix-theory"></span><h2><a class="toc-backref" href="#id7">Dynamical matrix</a><a class="headerlink" href="#dynamical-matrix" title="Permalink to this headline">¶</a></h2>
<p>In phonopy, a phase convention of dynamical matrix is used as follows:</p>
<div class="math" id="equation-eq_dynmat">
<span class="eqno">(1)<a class="headerlink" href="#equation-eq_dynmat" title="Permalink to this equation">¶</a></span>\[D_{\alpha\beta}(jj',\mathbf{q}) = \frac{1}{\sqrt{m_j m_{j'}}}
 \sum_{l'}
 \Phi_{\alpha\beta}(j0, j'l')
 \exp(i\mathbf{q}\cdot[\mathbf{r}(j'l')-\mathbf{r}(j0)]),\]</div>
<p>where <span class="math">\(m\)</span> is the atomic mass and <span class="math">\(\mathbf{q}\)</span> is the wave
vector. An equation of motion is written as</p>
<div class="math">
\[\sum_{j'\beta} D_{\alpha\beta}(jj',\mathbf{q}) e_\beta(j', \mathbf{q}\nu) =
m_j [ \omega(\mathbf{q}\nu) ]^2 e_\alpha(j, \mathbf{q}\nu).\]</div>
<p>where the eigenvector of the band index <span class="math">\(\nu\)</span> at
<span class="math">\(\mathbf{q}\)</span> is obtained by the diagonalization of
<span class="math">\(\mathbf{D}(\mathbf{q})\)</span>:</p>
<div class="math">
\[\sum_{j \alpha j' \beta}e_\alpha(j',\mathbf{q}\nu)^* D_{\alpha\beta}(jj',\mathbf{q})
e_\beta(j',\mathbf{q}\nu') = [\omega(\mathbf{q}\nu)]^2 \delta_{\nu\nu'}.\]</div>
<p>The atomic displacements <span class="math">\(\mathbf{u}\)</span> are given as</p>
<div class="math">
\[u_\alpha(jl,t) = \left(\frac{\hbar}{2Nm_j}\right)^{\frac{1}{2}}
\sum_{\mathbf{q},\nu}\left[\omega(\mathbf{q}\nu)\right]^{-\frac{1}{2}}
\left[\hat{a}(\mathbf{q}\nu)\exp(-i\omega(\mathbf{q}\nu)t)+
\hat{a}^\dagger(\mathbf{-q}\nu)\exp({i\omega(\mathbf{q}\nu)}t)\right]
\exp({i\mathbf{q}\cdot\mathbf{r}(jl)})
e_\alpha(j,\mathbf{q}\nu),\]</div>
<p>where <span class="math">\(\hat{a}^\dagger\)</span> and <span class="math">\(\hat{a}\)</span> are the creation and
annihilation operators of phonon, <span class="math">\(\hbar\)</span> is the reduced Planck
constant, and <span class="math">\(t\)</span> is the time.</p>
</div>
<div class="section" id="non-analytical-term-correction">
<span id="non-analytical-term-correction-theory"></span><h2><a class="toc-backref" href="#id8">Non-analytical term correction</a><a class="headerlink" href="#non-analytical-term-correction" title="Permalink to this headline">¶</a></h2>
<p>To correct long range interaction of macroscopic electric field
induced by polarization of collective ionic motions near the
<span class="math">\(\Gamma\)</span>-point, non-analytical term is added to dynamical matrix
(<a class="reference internal" href="reference.html#reference-nac"><span class="std std-ref">Non-analytical term correction</span></a>).  At
<span class="math">\(\mathbf{q}\to\mathbf{0}\)</span>, the dynamical matrix with
non-analytical term is given by,</p>
<div class="math">
\[D_{\alpha\beta}(jj',\mathbf{q}\to \mathbf{0}) =
 D_{\alpha\beta}(jj',\mathbf{q}=\mathbf{0})
 + \frac{1}{\sqrt{m_j m_{j'}}} \frac{4\pi}{\Omega_0}
 \frac{\left[\sum_{\gamma}q_{\gamma}Z^{*}_{j,\gamma\alpha}\right]
 \left[\sum_{\gamma'}q_{\gamma'}Z^{*}_{j',\gamma'\beta}\right]}
 {\sum_{\alpha\beta}q_{\alpha}\epsilon_{\alpha\beta}^{\infty}
 q_{\beta}}.\]</div>
<p>Phonon frequencies at general <strong>q</strong>-points are interpolated by the
method of Wang <em>et al.</em> (<a class="reference internal" href="reference.html#reference-wang-nac"><span class="std std-ref">Interpolation scheme at general q-points with non-analytical term correction</span></a>).</p>
</div>
<div class="section" id="thermodynamic-properties">
<span id="thermal-properties-expressions"></span><h2><a class="toc-backref" href="#id9">Thermodynamic properties</a><a class="headerlink" href="#thermodynamic-properties" title="Permalink to this headline">¶</a></h2>
<div class="section" id="phonon-number">
<h3><a class="toc-backref" href="#id10">Phonon number</a><a class="headerlink" href="#phonon-number" title="Permalink to this headline">¶</a></h3>
<div class="math">
\[n = \frac{1}{\exp(\hbar\omega(\mathbf{q}\nu)/k_\mathrm{B} T)-1}\]</div>
</div>
<div class="section" id="harmonic-phonon-energy">
<h3><a class="toc-backref" href="#id11">Harmonic phonon energy</a><a class="headerlink" href="#harmonic-phonon-energy" title="Permalink to this headline">¶</a></h3>
<div class="math">
\[E = \sum_{\mathbf{q}\nu}\hbar\omega(\mathbf{q}\nu)\left[\frac{1}{2} +
 \frac{1}{\exp(\hbar\omega(\mathbf{q}\nu)/k_\mathrm{B} T)-1}\right]\]</div>
</div>
<div class="section" id="constant-volume-heat-capacity">
<h3><a class="toc-backref" href="#id12">Constant volume heat capacity</a><a class="headerlink" href="#constant-volume-heat-capacity" title="Permalink to this headline">¶</a></h3>
<div class="math">
\[\begin{split}C_V &amp;= \left(\frac{\partial E}{\partial T} \right)_V \\
    &amp;= \sum_{\mathbf{q}\nu} k_\mathrm{B}
 \left(\frac{\hbar\omega(\mathbf{q}\nu)}{k_\mathrm{B} T} \right)^2
 \frac{\exp(\hbar\omega(\mathbf{q}\nu)/k_\mathrm{B}
 T)}{[\exp(\hbar\omega(\mathbf{q}\nu)/k_\mathrm{B} T)-1]^2}\end{split}\]</div>
</div>
<div class="section" id="partition-function">
<h3><a class="toc-backref" href="#id13">Partition function</a><a class="headerlink" href="#partition-function" title="Permalink to this headline">¶</a></h3>
<div class="math">
\[Z = \exp(-\varphi/k_\mathrm{B} T) \prod_{\mathbf{q}\nu}
 \frac{\exp(-\hbar\omega(\mathbf{q}\nu)/2k_\mathrm{B}
 T)}{1-\exp(-\hbar\omega(\mathbf{q}\nu)/k_\mathrm{B} T)}\]</div>
</div>
<div class="section" id="helmholtz-free-energy">
<h3><a class="toc-backref" href="#id14">Helmholtz free energy</a><a class="headerlink" href="#helmholtz-free-energy" title="Permalink to this headline">¶</a></h3>
<div class="math">
\[\begin{split}F &amp;= -k_\mathrm{B} T \ln Z \\
  &amp;= \varphi + \frac{1}{2} \sum_{\mathbf{q}\nu}
\hbar\omega(\mathbf{q}\nu) + k_\mathrm{B} T \sum_{\mathbf{q}\nu} \ln
\bigl[1 -\exp(-\hbar\omega(\mathbf{q}\nu)/k_\mathrm{B} T) \bigr]\end{split}\]</div>
</div>
<div class="section" id="entropy">
<h3><a class="toc-backref" href="#id15">Entropy</a><a class="headerlink" href="#entropy" title="Permalink to this headline">¶</a></h3>
<div class="math">
\[\begin{split}S &amp;= -\frac{\partial F}{\partial T} \\ &amp;= \frac{1}{2T}
  \sum_{\mathbf{q}\nu} \hbar\omega(\mathbf{q}\nu)
  \coth(\hbar\omega(\mathbf{q}\nu)/2k_\mathrm{B}T)-k_\mathrm{B}
  \sum_{\mathbf{q}\nu}
  \ln\left[2\sinh(\hbar\omega(\mathbf{q}\nu)/2k_\mathrm{B}T)\right]\end{split}\]</div>
</div>
</div>
<div class="section" id="thermal-displacement">
<span id="id2"></span><h2><a class="toc-backref" href="#id16">Thermal displacement</a><a class="headerlink" href="#thermal-displacement" title="Permalink to this headline">¶</a></h2>
<div class="section" id="mean-square-displacement">
<h3><a class="toc-backref" href="#id17">Mean square displacement</a><a class="headerlink" href="#mean-square-displacement" title="Permalink to this headline">¶</a></h3>
<p>From Eq. (10.71) in the book “Thermodynamics of Crystal”, atomic
displacement, <strong>u</strong>, is written by</p>
<div class="math">
\[u^\alpha(jl,t) = \left(\frac{\hbar}{2Nm_j}\right)^{\frac{1}{2}}
\sum_{\mathbf{q},\nu}\left[\omega_\nu(\mathbf{q})\right]^{-\frac{1}{2}}
\left[\hat{a}_\nu(\mathbf{q})\exp(-i\omega_\nu(\mathbf{q})t)+
\hat{a}^\dagger_\nu(\mathbf{-q})\exp({i\omega_\nu(\mathbf{q})}t)\right]
\exp({i\mathbf{q}\cdot\mathbf{r}(jl)})
e^\alpha_\nu(j,\mathbf{q})\]</div>
<p>where <em>j</em> and <em>l</em> are the labels for the <em>j</em>-th atomic position in the
<em>l</em>-th unit cell, <em>t</em> is the time, <span class="math">\(\alpha\)</span> is an axis (a
Cartesian axis in the default behavior of phonopy), <em>m</em> is the atomic
mass, <em>N</em> is the number of the unit cells, <span class="math">\(\mathbf{q}\)</span> is the
wave vector, <span class="math">\(\nu\)</span> is the index of phonon mode. <em>e</em> is the
polarization vector of the atom <em>jl</em> and the band <span class="math">\(\nu\)</span> at
<span class="math">\(\mathbf{q}\)</span>. <span class="math">\(\mathbf{r}(jl)\)</span> is the atomic position and
<span class="math">\(\omega\)</span> is the phonon frequency. <span class="math">\(\hat{a}^\dagger\)</span> and
<span class="math">\(\hat{a}\)</span> are the creation and annihilation operators of
phonon. The expectation value of the squared atomic displacement is
calculated as,</p>
<div class="math">
\[\left\langle |u^\alpha(jl, t)|^2 \right\rangle = \frac{\hbar}{2Nm_j}
\sum_{\mathbf{q},\nu}\omega_\nu(\mathbf{q})^{-1}
(1+2n_\nu(\mathbf{q},T))|e^\alpha_\nu(j,\mathbf{q})|^2,\]</div>
<p>where <span class="math">\(n_\nu(\mathbf{q},T)\)</span> is the phonon population, which is give by,</p>
<div class="math">
\[n_\nu(\mathbf{q},T) =
\frac{1}{\exp(\hbar\omega_\nu(\mathbf{q})/\mathrm{k_B}T)-1},\]</div>
<p>where <em>T</em> is the temperature, and <span class="math">\(\mathrm{k_B}\)</span> is the
Boltzmann constant. The equation is calculated using the commutation
relation of the creation and annihilation operators and the
expectation values of the combination of the operations, e.g.,</p>
<div class="math">
\[\begin{split}[ \hat{a}_\nu(\mathbf{q}), \hat{a}^\dagger_{\nu'}(\mathbf{q'}) ]
&amp;= \delta(\mathbf{q}-\mathbf{q}')\delta_{\nu\nu'},\\
[ \hat{a}_\nu(\mathbf{q}), \hat{a}_{\nu'}(\mathbf{q'}) ] &amp;= 0,\\
[ \hat{a}^\dagger_\nu(\mathbf{q}), \hat{a}^\dagger_{\nu'}(\mathbf{q'}) ] &amp;= 0,\\
\langle|\hat{a}_\nu(\mathbf{q})\hat{a}_{\nu'}(\mathbf{q'})|\rangle &amp;= 0,\\
\langle|\hat{a}^\dagger_\nu(\mathbf{q})\hat{a}^\dagger_{\nu'}(\mathbf{q'})|\rangle
&amp;= 0.\end{split}\]</div>
</div>
<div class="section" id="mean-square-displacement-matrix">
<span id="thermal-displacement-matrix"></span><h3><a class="toc-backref" href="#id18">Mean square displacement matrix</a><a class="headerlink" href="#mean-square-displacement-matrix" title="Permalink to this headline">¶</a></h3>
<p>Mean square displacement matrix is defined as follows:</p>
<div class="math">
\[\mathrm{U}_\text{cart}(j, T) = \frac{\hbar}{2Nm_j}
\sum_{\mathbf{q},\nu}\omega_\nu(\mathbf{q},T)^{-1}
(1+2n_\nu(\mathbf{q}))
\mathbf{e}_\nu(j,\mathbf{q}) \otimes \mathbf{e}^*_\nu(j,\mathbf{q}).\]</div>
<p>This is a symmetry matrix and diagonal elements are same as mean
square displacement calculated along Cartesian x, y, z directions.</p>
</div>
<div class="section" id="projection-to-an-arbitrary-axis-from-the-cartesian-axes">
<h3><a class="toc-backref" href="#id19">Projection to an arbitrary axis from the Cartesian axes</a><a class="headerlink" href="#projection-to-an-arbitrary-axis-from-the-cartesian-axes" title="Permalink to this headline">¶</a></h3>
<p>In phonopy, eigenvectors are calculated in the Cartesian axes that are
defined in the input structure file. Mean square displacement along an
arbitrary axis is obtained projecting eigenvectors in the Cartesian
axes as follows:</p>
<div class="math">
\[\left\langle |u(jl, t)|^2 \right\rangle = \frac{\hbar}{2Nm_j}
\sum_{\mathbf{q},\nu}\omega_\nu(\mathbf{q})^{-1}
(1+2n_\nu(\mathbf{q}))|
\hat{\mathbf{n}}\cdot\mathbf{e}_\nu(j,\mathbf{q})|^2\]</div>
<p>where <span class="math">\(\hat{\mathbf{n}}\)</span> is an arbitrary unit direction.</p>
</div>
<div class="section" id="mean-square-displacement-matrix-in-cif-format">
<h3><a class="toc-backref" href="#id20">Mean square displacement matrix in cif format</a><a class="headerlink" href="#mean-square-displacement-matrix-in-cif-format" title="Permalink to this headline">¶</a></h3>
<p>According to the paper by Grosse-Kunstleve and Adams [J. Appl. Cryst.,
35, 477-480 (2002)], mean square displacement matrix in the cif
definition (<code class="docutils literal"><span class="pre">aniso_U</span></code>),
<span class="math">\(\mathrm{U}_\text{cif}\)</span>, is obtained by</p>
<div class="math">
\[\mathrm{U}_\text{cif} = (\mathrm{AN})^{-1}\mathrm{U}_\text{cart}
(\mathrm{AN})^{-\mathrm{T}},\]</div>
<p>where <span class="math">\(\mathrm{A}\)</span> is the matrix to transform a point in fractional
coordinates to the Cartesian coordinates and <span class="math">\(\mathrm{N}\)</span> is the
diagonal matrix made of reciprocal basis vector lengths as follows:</p>
<div class="math">
\[\begin{split}\mathrm{A} = \begin{pmatrix}
a_x &amp; b_x &amp; c_x \\
a_y &amp; b_y &amp; c_y \\
a_z &amp; b_z &amp; c_z
\end{pmatrix}\end{split}\]</div>
<p>and</p>
<div class="math">
\[\begin{split}\mathrm{N} = \begin{pmatrix}
a^* &amp; 0 &amp; 0 \\
0 &amp; b^* &amp; 0 \\
0 &amp; 0 &amp; c^*
\end{pmatrix}.\end{split}\]</div>
<p><span class="math">\(a^*\)</span>, <span class="math">\(b^*\)</span>, <span class="math">\(c^*\)</span> are defined without <span class="math">\(2\pi\)</span>.</p>
</div>
</div>
<div class="section" id="group-velocity">
<span id="id3"></span><h2><a class="toc-backref" href="#id21">Group velocity</a><a class="headerlink" href="#group-velocity" title="Permalink to this headline">¶</a></h2>
<div class="section" id="method">
<h3><a class="toc-backref" href="#id22">Method</a><a class="headerlink" href="#method" title="Permalink to this headline">¶</a></h3>
<p>Phonopy calculates group velocity of phonon as follows:</p>
<div class="math">
\[\begin{split}\mathbf{v}_\mathrm{g}(\mathbf{q}\nu) = &amp; \nabla_\mathbf{q} \omega(\mathbf{q}\nu) \\
=&amp;\frac{\partial\omega(\mathbf{q}\nu)}{\partial \mathbf{q}} \\
=&amp;\frac{1}{2\omega(\mathbf{q}\nu)}\frac{\partial[\omega(\mathbf{q}\nu)]^2}{\partial
\mathbf{q}} \\
=&amp;\frac{1}{2\omega(\mathbf{q}\nu)}\left&lt;\mathbf{e}(\mathbf{q}\nu)\biggl|
\frac{\partial D(\mathbf{q})} {\partial
\mathbf{q}}\biggl|\mathbf{e}(\mathbf{q}\nu)\right&gt;,\end{split}\]</div>
<p>where the meanings of the variables are found at <a class="reference internal" href="#formulations"><span class="std std-ref">Formulations</span></a>.</p>
</div>
<div class="section" id="finite-difference-method">
<h3><a class="toc-backref" href="#id23">Finite difference method</a><a class="headerlink" href="#finite-difference-method" title="Permalink to this headline">¶</a></h3>
<p>In the previous versions, group velocity was calculated using finite
difference method:</p>
<div class="math">
\[\mathbf{v}_\mathrm{g}(\mathbf{q}\nu) =
\frac{1}{2\omega(\mathbf{q}\nu)}\left&lt;\mathbf{e}(\mathbf{q}\nu)\biggl|
\frac{\partial D(\mathbf{q})} {\partial
\mathbf{q}}\biggl|\mathbf{e}(\mathbf{q}\nu)\right&gt;
\simeq \frac{1}{2\omega(\mathbf{q}\nu)}
\left&lt;\mathbf{e}(\mathbf{q}\nu)\biggl|
\frac{\Delta D(\mathbf{q})}
{\Delta \mathbf{q}}\biggl|\mathbf{e}(\mathbf{q}\nu)\right&gt;.\]</div>
<p>Group velocity calculation with the finite difference method is still
able to be activated using <code class="docutils literal"><span class="pre">GV_DELTA_Q</span></code> tag or <code class="docutils literal"><span class="pre">-gv_delta_q</span></code>
option.  <span class="math">\(\Delta\mathbf{q} = (\Delta q_x, \Delta q_y, \Delta
q_z)\)</span> is described in Cartesian coordinated in reciprocal space. In
the implementation, central difference is employed, and <span class="math">\(+\Delta
q_\alpha\)</span> and <span class="math">\(-\Delta q_\alpha\)</span> are taken to calculate group
velocity, where <span class="math">\(\alpha\)</span> is the Cartesian index in reciprocal
space. <span class="math">\(\Delta q_\alpha\)</span> is specified in the unit of reciprocal
space distance (<span class="math">\(\mathrm{\AA}^{-1}\)</span> for the default case) by
<code class="docutils literal"><span class="pre">--gv_delta_q</span></code> option or <code class="docutils literal"><span class="pre">GV_DELTA_Q</span></code> tag.</p>
</div>
</div>
<div class="section" id="physical-unit-conversion">
<span id="id4"></span><h2><a class="toc-backref" href="#id24">Physical unit conversion</a><a class="headerlink" href="#physical-unit-conversion" title="Permalink to this headline">¶</a></h2>
<p>Phonopy calculates phonon frequencies based on input values from
users. In the default case, the physical units of distance, atomic
mass, force, and force constants are supposed to be
<span class="math">\(\text{\AA}\)</span>, <span class="math">\(\text{AMU}\)</span>, <span class="math">\(\text{eV/\AA}\)</span>, and
<span class="math">\(\text{eV/\AA}^2\)</span>, respectively, and the physical unit of the
phonon frequency is converted to THz. This conversion is made as
follows:</p>
<p>Internally phonon frequency has the physical unit of
<span class="math">\(\sqrt{\text{eV/}(\text{\AA}^2\cdot \text{AMU})}\)</span> in angular
frequency. To convert this unit to THz (not angular frequency), the
calculation of <code class="docutils literal"><span class="pre">sqrt(EV/AMU)/Angstrom/(2*pi)/1e12</span></code> is made. <code class="docutils literal"><span class="pre">EV</span></code>,
<code class="docutils literal"><span class="pre">AMU</span></code>, <code class="docutils literal"><span class="pre">Angstrom</span></code> are the values to convert them to those in the
SI base unit, i.e., to Joule, kg, and metre, respectively. These values
implemented in phonopy are found at <a class="reference external" href="https://github.com/atztogo/phonopy/blob/master/phonopy/units.py">a phonopy github page</a>. This
unit conversion factor can be manually specified. See
<a class="reference internal" href="setting-tags.html#frequency-conversion-factor-tag"><span class="std std-ref">FREQUENCY_CONVERSION_FACTOR</span></a>.</p>
<p>The unit conversion factor in the <code class="docutils literal"><span class="pre">BORN</span></code> file is multiplied with the second
term of the right hand side of the equation in
<a class="reference internal" href="#non-analytical-term-correction-theory"><span class="std std-ref">Non-analytical term correction</span></a> where this equation is written
with atomic units (<a class="reference internal" href="reference.html#reference-nac"><span class="std std-ref">Gonze and Lee, 1997</span></a>).
The physical unit of the part of the equation corresponding to force
constants:</p>
<div class="math">
\[\frac{4\pi}{\Omega_0}
\frac{[\sum_{\gamma}q_{\gamma}Z^{*}_{j,\gamma\alpha}]
[\sum_{\gamma'}q_{\gamma'}Z^{*}_{j',\gamma'\beta}]}
{\sum_{\alpha\beta}q_{\alpha}\epsilon_{\alpha\beta}^{\infty} q_{\beta}}.\]</div>
<p>is <span class="math">\([\text{hartree}/\text{bohr}^2]\)</span>. In the default case for the
VASP interface, internally <span class="math">\(\Omega_0\)</span> is given in
<span class="math">\(\text{\AA}^3\)</span>. In total, the necessary unit conversion is
<span class="math">\((\text{hartree} \rightarrow \text{eV}) \times (\text{bohr}
\rightarrow \text{\AA})=14.4\)</span>. In the default case of the Wien2k
interface, the conversion factor is <span class="math">\((\text{hartree}
\rightarrow \text{mRy})=2000\)</span>. For the other interfaces, the
conversion factors are similarly calculated following the unit
systems employed in phonopy (<a class="reference internal" href="interfaces.html#calculator-interfaces"><span class="std std-ref">Interfaces to calculators</span></a>).</p>
</div>
<div class="section" id="crystal-structure">
<span id="definition-of-commensurate-points"></span><h2><a class="toc-backref" href="#id25">Crystal structure</a><a class="headerlink" href="#crystal-structure" title="Permalink to this headline">¶</a></h2>
<div class="section" id="coordinates-in-direct-and-reciprocal-spaces">
<h3><a class="toc-backref" href="#id26">Coordinates in direct and reciprocal spaces</a><a class="headerlink" href="#coordinates-in-direct-and-reciprocal-spaces" title="Permalink to this headline">¶</a></h3>
<p>As usual, in phonopy, the Born-von Karman boundary condition is
assumed. Basis vectors of a primitive lattice are defined in three
column vectors <span class="math">\(( \mathbf{a} \; \mathbf{b} \; \mathbf{c}
)\)</span>. Coordinates of a point in the direct space <span class="math">\(\mathbf{r}\)</span> is
represented with respect to these basis vectors. The direct lattice
points are given by <span class="math">\(i
\mathbf{a} + j \mathbf{b} + k \mathbf{a}, \{i,
j, k \in \mathbb{Z}\}\)</span>, and the points for atoms in a unit cell <span class="math">\(x
\mathbf{a} + y \mathbf{b} + z \mathbf{a}, \{0 \le x, y, z
&lt; 1\}\)</span>. Basis vectors of the reciprocal
lattice may be given by three row vectors, <span class="math">\(( \mathbf{a}^{*T}
/\; \mathbf{b}^{*T} /\; \mathbf{c}^{*T} )\)</span>, but here they are defined
as three column vectors as <span class="math">\(( \mathbf{a}^{*} \; \mathbf{b}^{*}
\; \mathbf{c}^{*} )\)</span> with</p>
<div class="math" id="equation-eq_rec_basis_vectors">
<span class="eqno">(2)<a class="headerlink" href="#equation-eq_rec_basis_vectors" title="Permalink to this equation">¶</a></span>\[\begin{split}\mathbf{a}^{*} &amp;= \frac{\mathbf{b} \times \mathbf{c}}{\mathbf{a} \cdot
(\mathbf{b} \times \mathbf{c})}, \\
\mathbf{b}^{*} &amp;= \frac{\mathbf{c} \times \mathbf{a}}{\mathbf{b} \cdot
(\mathbf{c} \times \mathbf{a})}, \\
\mathbf{c}^{*} &amp;= \frac{\mathbf{a} \times \mathbf{b}}{\mathbf{c} \cdot
(\mathbf{a} \times \mathbf{b})}.\end{split}\]</div>
<p>Coordinates of a point in the reciprocal space <span class="math">\(\mathbf{q}\)</span> is
represented with respect to these basis vectors, therefore <span class="math">\(q_x
\mathbf{a}^{*} + q_y \mathbf{b}^{*} + q_z \mathbf{c}^{*}\)</span>. The
reciprocal lattice points are given by <span class="math">\(G_x\mathbf{a}^{*} + G_y
\mathbf{b}^{*} + G_z \mathbf{c}^{*}, \{G_x,
G_y, G_z \in \mathbb{Z}\}\)</span>. Following these definition, phase
factor should be represented as <span class="math">\(\exp(2\pi
i\mathbf{q}\cdot\mathbf{r})\)</span>, however in phonopy documentation,
<span class="math">\(2\pi\)</span> is implicitly included and not shown, i.e., it is
represented like <span class="math">\(\exp(i\mathbf{q}\cdot\mathbf{r})\)</span> (e.g., see
Eq. <a class="reference internal" href="#equation-eq_dynmat">(1)</a>). In the output of the reciprocal basis vectors,
<span class="math">\(2\pi\)</span> is not included, e.g., in <code class="docutils literal"><span class="pre">band.yaml</span></code>.</p>
<p>In phonopy, unless <a class="reference internal" href="setting-tags.html#primitive-axis-tag"><span class="std std-ref">PRIMITIVE_AXIS or PRIMITIVE_AXES</span></a> (or <code class="docutils literal"><span class="pre">--pa</span></code> option) is
specified, basis vectors in direct space <span class="math">\(( \mathbf{a} \;
\mathbf{b} \; \mathbf{c})\)</span> are set from the input unit celll structure
even if it is a supercell or a conventional unit cell having centring,
therefore the basis vectors in the reciprocal space are given by
Eq. <a class="reference internal" href="#equation-eq_rec_basis_vectors">(2)</a>. When using <a class="reference internal" href="setting-tags.html#primitive-axis-tag"><span class="std std-ref">PRIMITIVE_AXIS or PRIMITIVE_AXES</span></a>,
<span class="math">\(( \mathbf{a} \; \mathbf{b} \; \mathbf{c})\)</span> are set from those
transformed by the transformation matrix <span class="math">\(M_\text{p}\)</span> as written
at <a class="reference internal" href="setting-tags.html#primitive-axis-tag"><span class="std std-ref">PRIMITIVE_AXIS or PRIMITIVE_AXES</span></a>, therefore <span class="math">\(( \mathbf{a}^{*} \;
\mathbf{b}^{*} \; \mathbf{c}^{*} )\)</span> are given by those calculated
following Eq. <a class="reference internal" href="#equation-eq_rec_basis_vectors">(2)</a> with this <span class="math">\(( \mathbf{a}
\; \mathbf{b} \; \mathbf{c})\)</span>.</p>
</div>
<div class="section" id="commensurate-points">
<h3><a class="toc-backref" href="#id27">Commensurate points</a><a class="headerlink" href="#commensurate-points" title="Permalink to this headline">¶</a></h3>
<p>In phonopy, so-called commensurate points mean the q-points whose waves are
confined in the supercell used in the phonon calculation.</p>
<p>To explain about the commensurate points, let basis vectors of a
primitive cell in direct space cell be the column vectors
<span class="math">\((\mathbf{a}_\mathrm{p} \; \mathbf{b}_\mathrm{p} \;
\mathbf{c}_\mathrm{p})\)</span> and those of the supercell be
<span class="math">\((\mathbf{a}_\mathrm{s} \; \mathbf{b}_\mathrm{s} \;
\mathbf{c}_\mathrm{s})\)</span>. The transformation of the basis vectors from
the primitive cell to the supercell is written as</p>
<div class="math">
\[( \mathbf{a}_\mathrm{s} \; \mathbf{b}_\mathrm{s} \; \mathbf{c}_\mathrm{s} )
=  ( \mathbf{a}_\mathrm{p} \; \mathbf{b}_\mathrm{p} \;
\mathbf{c}_\mathrm{p} ) \boldsymbol{P}.\]</div>
<p><span class="math">\(\boldsymbol{P}\)</span> is given as a <span class="math">\(3\times 3\)</span> matrix and its
elements are all integers, which is a constraint we have. The
resolution for q-points being the commensurate points is determined by
<span class="math">\(\boldsymbol{P}\)</span> since one period of a wave has to be bound by
any of lattice points inside the supercell. Therefore the number of
commensurate points becomes the same as the number of the primitive
cell that can be contained in the supercell, i.e.,
<span class="math">\(\det(\boldsymbol{P})\)</span>.</p>
<p>Then let the basis vectors in reciprocal space be the column vectors
<span class="math">\((\mathbf{a}^*_\mathrm{p} \; \mathbf{b}^*_\mathrm{p} \;
\mathbf{c}^*_\mathrm{p})\)</span>. Note that often reciprocal vectors are
deifned by row vectors, but column vectors are chosen here to
formulate. Formally we see the set of besis vectors are <span class="math">\(3\times
3\)</span> matrices, we have the following relation:</p>
<div class="math">
\[( \mathbf{a}^*_\mathrm{p} \;
\mathbf{b}^*_\mathrm{p} \; \mathbf{c}^*_\mathrm{p} ) = (
\mathbf{a}_\mathrm{p} \; \mathbf{b}_\mathrm{p} \;
\mathbf{c}_\mathrm{p} )^{-\mathbf{T}}.\]</div>
<p>Similarly for the supercell, we define a relation</p>
<div class="math">
\[( \mathbf{a}^*_\mathrm{s} \;
\mathbf{b}^*_\mathrm{s} \; \mathbf{c}^*_\mathrm{s} ) = (
\mathbf{a}_\mathrm{s} \; \mathbf{b}_\mathrm{s} \;
\mathbf{c}_\mathrm{s} )^{-\mathbf{T}}.\]</div>
<p>Then</p>
<div class="math">
\[( \mathbf{a}^*_\mathrm{s} \; \mathbf{b}^*_\mathrm{s} \;
\mathbf{c}^*_\mathrm{s} ) \boldsymbol{P}^{\mathrm{T}} = (
\mathbf{a}^*_\mathrm{p} \; \mathbf{b}^*_\mathrm{p} \;
\mathbf{c}^*_\mathrm{p} ).\]</div>
<p>To multiply an arbitrary q-point <span class="math">\(\mathbf{q}\)</span> on both sides</p>
<div class="math">
\[( \mathbf{a}^*_\mathrm{s} \; \mathbf{b}^*_\mathrm{s} \;
\mathbf{c}^*_\mathrm{s} ) \boldsymbol{P}^{\mathrm{T}} \mathbf{q} = (
\mathbf{a}^*_\mathrm{p} \; \mathbf{b}^*_\mathrm{p} \;
\mathbf{c}^*_\mathrm{p} ) \mathbf{q},\]</div>
<p>we find the constraint of a q-point being one of the commensurate points is
the elements of <span class="math">\(\boldsymbol{P}^{\mathrm{T}} \mathbf{q}\)</span> to be integers.</p>
</div>
</div>
</div>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
        <br/>
        
<div id="sourcelink">
  <a href="_sources/formulation.rst.txt"
     rel="nofollow">Source</a>
</div>
      
    </p>
    <p>
        &copy; Copyright 2009, Atsushi Togo.<br/>
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.6.3.<br/>
    </p>
  </div>
</footer>
  </body>
</html>