<!DOCTYPE html>


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Formulations &#8212; Phonopy v.1.11.10</title>
    
    <link rel="stylesheet" href="_static/basic.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/bootswatch-3.3.6/cosmo/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" href="_static/bootstrap-sphinx.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '1.11.10',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="_static/bootstrap-3.3.6/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="_static/bootstrap-sphinx.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Mean square displacement" href="thermal-displacement.html" />
    <link rel="prev" title="Using phonopy as a python module" href="phonopy-module.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">

  </head>
  <body role="document">

  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="index.html">
          Phonopy</a>
        <span class="navbar-text navbar-version pull-left"><b>1.11.10</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="index.html">Site <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><ul class="current">
<li class="toctree-l1"><a class="reference internal" href="introduction.html">Phonopy introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples.html">Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="procedure.html">Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="workflow.html">Work flow</a></li>
<li class="toctree-l1"><a class="reference internal" href="install.html">Download and install</a></li>
<li class="toctree-l1"><a class="reference internal" href="features.html">Features</a></li>
<li class="toctree-l1"><a class="reference internal" href="input-files.html">Input files</a></li>
<li class="toctree-l1"><a class="reference internal" href="output-files.html">Output files</a></li>
<li class="toctree-l1"><a class="reference internal" href="setting-tags.html">Setting tags</a></li>
<li class="toctree-l1"><a class="reference internal" href="command-options.html">Command options</a></li>
<li class="toctree-l1"><a class="reference internal" href="qha.html">Quasi harmonic approximation</a></li>
<li class="toctree-l1"><a class="reference internal" href="gruneisen.html">Mode Grüneisen parameters</a></li>
<li class="toctree-l1"><a class="reference internal" href="interfaces.html">Interfaces to calculators</a></li>
<li class="toctree-l1"><a class="reference internal" href="auxiliary-tools.html">Auxiliary tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="external-tools.html">External tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="phonopy-module.html">Using phonopy as a python module</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Formulations</a></li>
<li class="toctree-l1"><a class="reference internal" href="citation.html">How to cite phonopy</a></li>
<li class="toctree-l1"><a class="reference internal" href="reference.html">References</a></li>
<li class="toctree-l1"><a class="reference internal" href="changelog.html">Change Log</a></li>
</ul>
</ul>
</li>
              
                <li class="dropdown">
  <a role="button"
     id="dLabelLocalToc"
     data-toggle="dropdown"
     data-target="#"
     href="#">Page <b class="caret"></b></a>
  <ul class="dropdown-menu localtoc"
      role="menu"
      aria-labelledby="dLabelLocalToc"><ul>
<li><a class="reference internal" href="#">Formulations</a><ul>
<li><a class="reference internal" href="#second-order-force-constants">Second-order force constants</a></li>
<li><a class="reference internal" href="#modified-parlinski-li-kawazoe-method">Modified Parlinski-Li-Kawazoe method</a></li>
<li><a class="reference internal" href="#dynamical-matrix">Dynamical matrix</a></li>
<li><a class="reference internal" href="#non-analytical-term-correction">Non-analytical term correction</a></li>
<li><a class="reference internal" href="#thermodynamic-properties">Thermodynamic properties</a><ul>
<li><a class="reference internal" href="#phonon-number">Phonon number</a></li>
<li><a class="reference internal" href="#harmonic-phonon-energy">Harmonic phonon energy</a></li>
<li><a class="reference internal" href="#constant-volume-heat-capacity">Constant volume heat capacity</a></li>
<li><a class="reference internal" href="#partition-function">Partition function</a></li>
<li><a class="reference internal" href="#helmholtz-free-energy">Helmholtz free energy</a></li>
<li><a class="reference internal" href="#entropy">Entropy</a></li>
</ul>
</li>
<li><a class="reference internal" href="#thermal-displacement">Thermal displacement</a></li>
<li><a class="reference internal" href="#group-velocity">Group velocity</a></li>
<li><a class="reference internal" href="#physical-unit-conversion">Physical unit conversion</a></li>
<li><a class="reference internal" href="#commensurate-points">Commensurate points</a></li>
</ul>
</li>
</ul>
</ul>
</li>
              
            
            
              
                
  <li>
    <a href="phonopy-module.html" title="Previous Chapter: Using phonopy as a python module"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm hidden-tablet">&laquo; Using phonopy...</span>
    </a>
  </li>
  <li>
    <a href="thermal-displacement.html" title="Next Chapter: Mean square displacement"><span class="glyphicon glyphicon-chevron-right visible-sm"></span><span class="hidden-sm hidden-tablet">Mean square d... &raquo;</span>
    </a>
  </li>
              
            
            
            
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="col-md-12 content">
      
  <div class="section" id="formulations">
<span id="id1"></span><h1>Formulations<a class="headerlink" href="#formulations" title="Permalink to this headline">¶</a></h1>
<div class="contents local topic" id="contents">
<ul class="simple">
<li><a class="reference internal" href="#second-order-force-constants" id="id3">Second-order force constants</a></li>
<li><a class="reference internal" href="#modified-parlinski-li-kawazoe-method" id="id4">Modified Parlinski-Li-Kawazoe method</a></li>
<li><a class="reference internal" href="#dynamical-matrix" id="id5">Dynamical matrix</a></li>
<li><a class="reference internal" href="#non-analytical-term-correction" id="id6">Non-analytical term correction</a></li>
<li><a class="reference internal" href="#thermodynamic-properties" id="id7">Thermodynamic properties</a><ul>
<li><a class="reference internal" href="#phonon-number" id="id8">Phonon number</a></li>
<li><a class="reference internal" href="#harmonic-phonon-energy" id="id9">Harmonic phonon energy</a></li>
<li><a class="reference internal" href="#constant-volume-heat-capacity" id="id10">Constant volume heat capacity</a></li>
<li><a class="reference internal" href="#partition-function" id="id11">Partition function</a></li>
<li><a class="reference internal" href="#helmholtz-free-energy" id="id12">Helmholtz free energy</a></li>
<li><a class="reference internal" href="#entropy" id="id13">Entropy</a></li>
</ul>
</li>
<li><a class="reference internal" href="#thermal-displacement" id="id14">Thermal displacement</a></li>
<li><a class="reference internal" href="#group-velocity" id="id15">Group velocity</a></li>
<li><a class="reference internal" href="#physical-unit-conversion" id="id16">Physical unit conversion</a></li>
<li><a class="reference internal" href="#commensurate-points" id="id17">Commensurate points</a></li>
</ul>
</div>
<div class="section" id="second-order-force-constants">
<h2><a class="toc-backref" href="#id3">Second-order force constants</a><a class="headerlink" href="#second-order-force-constants" title="Permalink to this headline">¶</a></h2>
<p>Potential energy of phonon system is represented as functions of atomic
positions:</p>
<div class="math">
<p><img src="_images/math/2976aeb09ee588b5c1008a3e7ed24d5d45bfb268.png" alt="V[\mathbf{r}(j_1 l_1),\ldots,\mathbf{r}(j_n l_N)],"/></p>
</div><p>where <img class="math" src="_images/math/0c1332a41052512298350527298ed5d047f654b2.png" alt="\mathbf{r}(jl)"/> is the point of the <img class="math" src="_images/math/6b21e0b0899a0d2879d3b8019087fa630bab4ea2.png" alt="j"/>-th atom in
the <img class="math" src="_images/math/b359488b993294ebbc2c7b30ab8f749dcbc6826d.png" alt="l"/>-th unit cell and <img class="math" src="_images/math/e11f2701c4a39c7fe543a6c4150b421d50f1c159.png" alt="n"/> and <img class="math" src="_images/math/f4170ed8938b79490d8923857962695514a8e4cb.png" alt="N"/> are the number
of atoms in a unit cell and the number of unit cells, respectively.  A
force and a second-order force constant <img class="math" src="_images/math/1b75b194928fe90d91c2a94353fa45a65f8b3aab.png" alt="\Phi_{\alpha \beta}"/>
are given by</p>
<div class="math">
<p><img src="_images/math/bd3f50e2bbff112a18d70e3969b6364f35ffebdc.png" alt="F_\alpha(jl) = -\frac{\partial V }{\partial r_\alpha(jl)}"/></p>
</div><p>and</p>
<div class="math">
<p><img src="_images/math/475132f4cae5908834146416f0982fefc581a1c8.png" alt="\Phi_{\alpha\beta}(jl, j'l') = \frac{\partial^2
V}{\partial r_\alpha(jl) \partial r_\beta(j'l')} =
-\frac{\partial F_\beta(j'l')}{\partial r_\alpha(jl)},"/></p>
</div><p>respectively, where <img class="math" src="_images/math/877d234f4cec6974ce218fc2e975a486a7972dfd.png" alt="\alpha"/>, <img class="math" src="_images/math/410a9d0df9c135dd73b269cba7ef04dcfd932b1f.png" alt="\beta"/>, ..., are the
Cartesian indices, <img class="math" src="_images/math/6b21e0b0899a0d2879d3b8019087fa630bab4ea2.png" alt="j"/>, <img class="math" src="_images/math/c2ad8d4c5b22e815f7e626b1959bb8302ea961db.png" alt="j'"/>, ..., are the indices of
atoms in a unit cell, and <img class="math" src="_images/math/b359488b993294ebbc2c7b30ab8f749dcbc6826d.png" alt="l"/>, <img class="math" src="_images/math/bfdde7e4ea91791fc9760ac1412e28ef6885ab57.png" alt="l'"/>, ..., are
the indices of unit cells. In the finite displacement method, the
equation for the force constants is approximated as</p>
<div class="math">
<p><img src="_images/math/6c0dd3d97e442899d16c0ba255865f5de7f9f6c8.png" alt="\Phi_{\alpha\beta}(jl, j'l') \simeq -\frac{
F_\beta(j'l';\Delta r_\alpha{(jl)}) - F_\beta(j'l')} {\Delta
r_\alpha(jl)},"/></p>
</div><p>where <img class="math" src="_images/math/8580af892cb896c40e6247e1ad225c3a8adf7d93.png" alt="F_\beta(j'l'; \Delta r_\alpha{(jl)})"/> are the forces on
atoms with a finite displacement <img class="math" src="_images/math/4d12e6f5ef6d60f4286546352d70b40deb7a2f62.png" alt="\Delta r_\alpha{(jl)}"/> and
usually <img class="math" src="_images/math/018de6abbdf65ea676895ebd34038254a4bc0f4b.png" alt="F_\beta(j'l') \equiv 0"/>.</p>
</div>
<div class="section" id="modified-parlinski-li-kawazoe-method">
<span id="force-constants-solver-theory"></span><h2><a class="toc-backref" href="#id4">Modified Parlinski-Li-Kawazoe method</a><a class="headerlink" href="#modified-parlinski-li-kawazoe-method" title="Permalink to this headline">¶</a></h2>
<p>The following is a modified and simplified version of the
Parlinski-Li-Kawazoe method, which is just a numerical fitting
approach to obtain force constants from forces and displacements.</p>
<p>The last equation above is represented by matrices as</p>
<div class="math">
<p><img src="_images/math/d11e4f0202e73db04bbc30d2ac3a9aea956d09ac.png" alt="\mathbf{F} = - \mathbf{U} \mathbf{P},"/></p>
</div><p>where <img class="math" src="_images/math/12375c0b63626372bb53f970422bbbf888b2a1f2.png" alt="\mathbf{F}"/>, <img class="math" src="_images/math/2e1b9128d3c9b8fb56d099ad56863fd3a9137bb9.png" alt="\mathbf{P}"/>, and <img class="math" src="_images/math/2cc20366b0498f2efeb18a55e7b38436cb20c5ca.png" alt="\mathbf{U}"/>
for a pair of atoms, e.g. <img class="math" src="_images/math/21ac2e8b318e3611a424d6b0e1f58041d26583e2.png" alt="\{jl, j'l'\}"/>, are given by</p>
<div class="math">
<p><img src="_images/math/de78e287709687c9b54396f7250ee277ceed20fc.png" alt="\mathbf{F} =
 \begin{pmatrix}
  F_{x} &amp; F_{y} &amp; F_{z}
 \end{pmatrix},"/></p>
</div><div class="math">
<p><img src="_images/math/dfe3dd1b127f8c6d78f7372bf4d5839f32131d11.png" alt="\mathbf{P} =
  \begin{pmatrix}
  \Phi_{xx} &amp; \Phi_{xy} &amp; \Phi_{xz} \\
  \Phi_{yx} &amp; \Phi_{yy} &amp; \Phi_{yz} \\
  \Phi_{zx} &amp; \Phi_{zy} &amp; \Phi_{zz}
\end{pmatrix},"/></p>
</div><div class="math">
<p><img src="_images/math/baa049dea42563113122f7aa845101fe70f6e30b.png" alt="\mathbf{U} =
 \begin{pmatrix}
   \Delta r_{x} &amp; \Delta r_{y} &amp; \Delta r_{z} \\
 \end{pmatrix}."/></p>
</div><p>The matrix equation is expanded for number of
forces and displacements as follows:</p>
<div class="math">
<p><img src="_images/math/97d541f38c461ededa3a0bdd385d97ff23bc6853.png" alt="\begin{pmatrix}
\mathbf{F}_1 \\
\mathbf{F}_2 \\
 \vdots
\end{pmatrix}
= -
\begin{pmatrix}
\mathbf{U}_1 \\
\mathbf{U}_2 \\
 \vdots
\end{pmatrix}
\mathbf{P}."/></p>
</div><p>With sufficient number of atomic displacements, this
may be solved by pseudo inverse such as</p>
<div class="math">
<p><img src="_images/math/4786d09a922c55730f97b98f81a9f45c9dfe3707.png" alt="\mathbf{P} = -
\begin{pmatrix}
\mathbf{U}_1 \\
\mathbf{U}_2 \\
 \vdots
\end{pmatrix}^{+}
\begin{pmatrix}
\mathbf{F}_1 \\
\mathbf{F}_2 \\
\vdots
\end{pmatrix}."/></p>
</div><p>Required number of atomic displacements to solve the simultaneous
equations may be reduced using site-point symmetries. The matrix
equation can be written using a symmetry operation as</p>
<div class="math">
<p><img src="_images/math/1d85c3ae1e5eb165d41bbcadfe2bb7a27804bc7a.png" alt="\hat{R}(\mathbf{F}) = -\hat{R}(\mathbf{U})\mathbf{P},"/></p>
</div><p>where <img class="math" src="_images/math/4a6c73b7dc8040478fee88bd379fb9a33b36d597.png" alt="\hat{R}"/> is the site symmetry
operation centring at
<img class="math" src="_images/math/0c1332a41052512298350527298ed5d047f654b2.png" alt="\mathbf{r}(jl)"/>. <img class="math" src="_images/math/f08917d88c0110178be3fcf0577665d9ee5ba958.png" alt="\hat{R}(\mathbf{F})"/> and <img class="math" src="_images/math/4299d981df86924d483d747bb66be5a486d25645.png" alt="\hat{R}(\mathbf{U})"/> are defined as
<img class="math" src="_images/math/9344a69da82b2014744aa7b9da05004ac8fdd4f1.png" alt="\mathbf{RF}(\hat{R^{-1}}(j'l'))"/> and <img class="math" src="_images/math/8c1443877ee3daa2d7b6946780498380ed18f0a1.png" alt="\mathbf{RU}"/>,
respectively, where <img class="math" src="_images/math/41e1f27bd689b391a4833f34f85537ee4e688778.png" alt="\mathbf{R}"/> is the matrix
representation of the rotation operation. The combined
simultaneous equations are built such as</p>
<div class="math">
<p><img src="_images/math/fe991dffc77c1e521109671e959734e837080f4c.png" alt="\begin{pmatrix}
\mathbf{F}^{(1)}_1 \\
\mathbf{F}^{(2)}_1 \\
\vdots \\
\mathbf{F}^{(1)}_2 \\
\mathbf{F}^{(2)}_2 \\
\vdots \end{pmatrix} = -
\begin{pmatrix}
\mathbf{U}^{(1)}_1 \\
\vdots \\
\mathbf{U}^{(2)}_1 \\
\mathbf{U}^{(1)}_2 \\
\mathbf{U}^{(2)}_2 \\
\vdots
\end{pmatrix}
\mathbf{P}."/></p>
</div><p>where the superscript with parenthesis gives the index of
site-symmetry operations. This is solved by pseudo inverse.</p>
</div>
<div class="section" id="dynamical-matrix">
<span id="dynacmial-matrix-theory"></span><h2><a class="toc-backref" href="#id5">Dynamical matrix</a><a class="headerlink" href="#dynamical-matrix" title="Permalink to this headline">¶</a></h2>
<p>In phonopy, a phase convention of dynamical matrix is used as follows:</p>
<div class="math">
<p><img src="_images/math/6db16e75e73472b02204afdf329ca9505b316c2f.png" alt="D_{\alpha\beta}(jj',\mathbf{q}) = \frac{1}{\sqrt{m_j m_{j'}}}
 \sum_{l'}
 \Phi_{\alpha\beta}(j0, j'l')
 \exp(i\mathbf{q}\cdot[\mathbf{r}(j'l')-\mathbf{r}(j0)]),"/></p>
</div><p>where <img class="math" src="_images/math/edba97b4c0d864d26e92ea7ea73767fa38eef3f7.png" alt="m"/> is the atomic mass and <img class="math" src="_images/math/9658517ccd5cd64cff63909f92e47b5981b1b2b5.png" alt="\mathbf{q}"/> is the wave
vector. An equation of motion is written as</p>
<div class="math">
<p><img src="_images/math/dc035b70a0c4a4ea0161f45e6f2698243b8b3fa9.png" alt="\sum_{j'\beta} D_{\alpha\beta}(jj',\mathbf{q}) e_\beta(j', \mathbf{q}\nu) =
m_j [ \omega(\mathbf{q}\nu) ]^2 e_\alpha(j, \mathbf{q}\nu)."/></p>
</div><p>where the eigenvector of the band index <img class="math" src="_images/math/ca3b8fa4180eee2dfc3af9d13fae1da451cd2c31.png" alt="\nu"/> at
<img class="math" src="_images/math/9658517ccd5cd64cff63909f92e47b5981b1b2b5.png" alt="\mathbf{q}"/> is obtained by the diagonalization of
<img class="math" src="_images/math/3d4ebe663b60edcb3369b87e76eef10fe3a12df4.png" alt="\mathbf{D}(\mathbf{q})"/>:</p>
<div class="math">
<p><img src="_images/math/daee7aebbdb2b91f5a231d39a620127eb27fca89.png" alt="\sum_{j \alpha j' \beta}e_\alpha(j',\mathbf{q}\nu)^* D_{\alpha\beta}(jj',\mathbf{q})
e_\beta(j',\mathbf{q}\nu') = [\omega(\mathbf{q}\nu)]^2 \delta_{\nu\nu'}."/></p>
</div><p>The atomic displacements <img class="math" src="_images/math/2978d86319a8d5f6b72d697bce6ebfd0bcab6ca9.png" alt="\mathbf{u}"/> are given as</p>
<div class="math">
<p><img src="_images/math/66b82e1b872c40c05e673a91f87f396843233ec7.png" alt="u_\alpha(jl,t) = \left(\frac{\hbar}{2Nm_j}\right)^{\frac{1}{2}}
\sum_{\mathbf{q},\nu}\left[\omega(\mathbf{q}\nu)\right]^{-\frac{1}{2}}
\left[\hat{a}(\mathbf{q}\nu)\exp(-i\omega(\mathbf{q}\nu)t)+
\hat{a}^\dagger(\mathbf{-q}\nu)\exp({i\omega(\mathbf{q}\nu)}t)\right]
\exp({i\mathbf{q}\cdot\mathbf{r}(jl)})
e_\alpha(j,\mathbf{q}\nu),"/></p>
</div><p>where <img class="math" src="_images/math/7137b77e7927f934524e5a463e92a87d9c19fee4.png" alt="\hat{a}^\dagger"/> and <img class="math" src="_images/math/8d6498cc51196a2e38f403d0e4cf0a236f88531a.png" alt="\hat{a}"/> are the creation and
annihilation operators of phonon, <img class="math" src="_images/math/dbb9f0f1420060d59517126300ee0011b1a31620.png" alt="\hbar"/> is the reduced Planck
constant, and <img class="math" src="_images/math/5ec053cf70dc1c98cc297322250569eda193e7a4.png" alt="t"/> is the time.</p>
</div>
<div class="section" id="non-analytical-term-correction">
<span id="non-analytical-term-correction-theory"></span><h2><a class="toc-backref" href="#id6">Non-analytical term correction</a><a class="headerlink" href="#non-analytical-term-correction" title="Permalink to this headline">¶</a></h2>
<p>To correct long range interaction of macroscopic electric field
induced by polarization of collective ionic motions near the
<img class="math" src="_images/math/d872993ed0c7c420e73e77a1d285ac100c516806.png" alt="\Gamma"/>-point, non-analytical term is added to dynamical matrix
(<a class="reference internal" href="reference.html#reference-nac"><span class="std std-ref">Non-analytical term correction</span></a>).  At
<img class="math" src="_images/math/622aec0097d2d237e3195230d326c1e781524698.png" alt="\mathbf{q}\to\mathbf{0}"/>, the dynamical matrix with
non-analytical term is given by,</p>
<div class="math">
<p><img src="_images/math/a5a5bd56a7ec3966ac7b54bda368036d7b30810a.png" alt="D_{\alpha\beta}(jj',\mathbf{q}\to \mathbf{0}) =
 D_{\alpha\beta}(jj',\mathbf{q}=\mathbf{0})
 + \frac{1}{\sqrt{m_j m_j}} \frac{4\pi}{\Omega_0}
 \frac{[\sum_{\gamma}q_{\gamma}Z^{*}_{j,\gamma\alpha}][\sum_{\gamma'}q_{\gamma'}Z^{*}_{j',\gamma'\beta}]}
 {\sum_{\alpha\beta}q_{\alpha}\epsilon_{\alpha\beta}^{\infty} q_{\beta}}."/></p>
</div><p>Phonon frequencies at general <strong>q</strong>-points are interpolated by the
method of Wang <em>et al.</em> (<a class="reference internal" href="reference.html#reference-wang-nac"><span class="std std-ref">Interpolation scheme at general q-points with non-analytical term correction</span></a>).</p>
</div>
<div class="section" id="thermodynamic-properties">
<span id="thermal-properties-expressions"></span><h2><a class="toc-backref" href="#id7">Thermodynamic properties</a><a class="headerlink" href="#thermodynamic-properties" title="Permalink to this headline">¶</a></h2>
<div class="section" id="phonon-number">
<h3><a class="toc-backref" href="#id8">Phonon number</a><a class="headerlink" href="#phonon-number" title="Permalink to this headline">¶</a></h3>
<div class="math">
<p><img src="_images/math/ba3ceb5abd36a528d579451935962b51ebcb54d7.png" alt="n = \frac{1}{\exp(\hbar\omega(\mathbf{q}\nu)/k_\mathrm{B} T)-1}"/></p>
</div></div>
<div class="section" id="harmonic-phonon-energy">
<h3><a class="toc-backref" href="#id9">Harmonic phonon energy</a><a class="headerlink" href="#harmonic-phonon-energy" title="Permalink to this headline">¶</a></h3>
<div class="math">
<p><img src="_images/math/fc317f43452c21e7352a98a6a4d541ba387db630.png" alt="E = \sum_{\mathbf{q}\nu}\hbar\omega(\mathbf{q}\nu)\left[\frac{1}{2} +
 \frac{1}{\exp(\hbar\omega(\mathbf{q}\nu)/k_\mathrm{B} T)-1}\right]"/></p>
</div></div>
<div class="section" id="constant-volume-heat-capacity">
<h3><a class="toc-backref" href="#id10">Constant volume heat capacity</a><a class="headerlink" href="#constant-volume-heat-capacity" title="Permalink to this headline">¶</a></h3>
<div class="math">
<p><img src="_images/math/6f261a01600d205a8ee948ef0d715e424a09f0dd.png" alt="C_V &amp;= \left(\frac{\partial E}{\partial T} \right)_V \\
    &amp;= \sum_{\mathbf{q}\nu} k_\mathrm{B}
 \left(\frac{\hbar\omega(\mathbf{q}\nu)}{k_\mathrm{B} T} \right)^2
 \frac{\exp(\hbar\omega(\mathbf{q}\nu)/k_\mathrm{B}
 T)}{[\exp(\hbar\omega(\mathbf{q}\nu)/k_\mathrm{B} T)-1]^2}"/></p>
</div></div>
<div class="section" id="partition-function">
<h3><a class="toc-backref" href="#id11">Partition function</a><a class="headerlink" href="#partition-function" title="Permalink to this headline">¶</a></h3>
<div class="math">
<p><img src="_images/math/6e17359b6c1c0b3d907db54031961d4432247833.png" alt="Z = \exp(-\varphi/k_\mathrm{B} T) \prod_{\mathbf{q}\nu}
 \frac{\exp(-\hbar\omega(\mathbf{q}\nu)/2k_\mathrm{B}
 T)}{1-\exp(-\hbar\omega(\mathbf{q}\nu)/k_\mathrm{B} T)}"/></p>
</div></div>
<div class="section" id="helmholtz-free-energy">
<h3><a class="toc-backref" href="#id12">Helmholtz free energy</a><a class="headerlink" href="#helmholtz-free-energy" title="Permalink to this headline">¶</a></h3>
<div class="math">
<p><img src="_images/math/9ba322d95340ea54d019f0a3c951a679f89eae53.png" alt="F &amp;= -k_\mathrm{B} T \ln Z \\
  &amp;= \varphi + \frac{1}{2} \sum_{\mathbf{q}\nu}
\hbar\omega(\mathbf{q}\nu) + k_\mathrm{B} T \sum_{\mathbf{q}\nu} \ln
\bigl[1 -\exp(-\hbar\omega(\mathbf{q}\nu)/k_\mathrm{B} T) \bigr]"/></p>
</div></div>
<div class="section" id="entropy">
<h3><a class="toc-backref" href="#id13">Entropy</a><a class="headerlink" href="#entropy" title="Permalink to this headline">¶</a></h3>
<div class="math">
<p><img src="_images/math/b5ba9486062442f9182b64c8a40e61159f0ac989.png" alt="S &amp;= -\frac{\partial F}{\partial T} \\
  &amp;= \frac{1}{2T}\sum_{\mathbf{q}\nu}\hbar\omega(\mathbf{q}\nu)\coth(\hbar\omega(\mathbf{q}\nu)/2k_\mathrm{B}T)-k_\mathrm{B} \sum_{\mathbf{q}\nu}\ln\left[2\sinh(\hbar\omega(\mathbf{q}\nu)/2k_\mathrm{B}T)\right]"/></p>
</div></div>
</div>
<div class="section" id="thermal-displacement">
<h2><a class="toc-backref" href="#id14">Thermal displacement</a><a class="headerlink" href="#thermal-displacement" title="Permalink to this headline">¶</a></h2>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="thermal-displacement.html">Mean square displacement</a></li>
<li class="toctree-l1"><a class="reference internal" href="thermal-displacement.html#mean-square-displacement-matrix">Mean square displacement matrix</a></li>
<li class="toctree-l1"><a class="reference internal" href="thermal-displacement.html#projection-to-an-arbitrary-axis-from-the-cartesian-axes">Projection to an arbitrary axis from the Cartesian axes</a></li>
<li class="toctree-l1"><a class="reference internal" href="thermal-displacement.html#mean-square-displacement-matrix-in-cif-format">Mean square displacement matrix in cif format</a></li>
</ul>
</div>
</div>
<div class="section" id="group-velocity">
<h2><a class="toc-backref" href="#id15">Group velocity</a><a class="headerlink" href="#group-velocity" title="Permalink to this headline">¶</a></h2>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="group-velocity.html">Method</a></li>
<li class="toctree-l1"><a class="reference internal" href="group-velocity.html#finite-difference-method">Finite difference method</a></li>
</ul>
</div>
</div>
<div class="section" id="physical-unit-conversion">
<span id="id2"></span><h2><a class="toc-backref" href="#id16">Physical unit conversion</a><a class="headerlink" href="#physical-unit-conversion" title="Permalink to this headline">¶</a></h2>
<p>Phonopy calculates phonon frequencies based on input values from
users. In the default case, the physical units of distance, atomic
mass, force, and force constants are supposed to be
<img class="math" src="_images/math/04434c28148d7cc7b890adfcbcba587062175696.png" alt="\text{\AA}"/>, <img class="math" src="_images/math/82e7a990d119f5ad6cb4502d4de66272989f89f7.png" alt="\text{AMU}"/>, <img class="math" src="_images/math/ad046f29983437aac7cb11ee0796f536abe71b96.png" alt="\text{eV/\AA}"/>, and
<img class="math" src="_images/math/0cc38c248fb53860f14cf0887e24c10e7fa4164b.png" alt="\text{eV/\AA}^2"/>, respectively, and the physical unit of the
phonon frequency is converted to THz. This conversion is made as
follows:</p>
<p>Internally phonon frequency has the physical unit of
<img class="math" src="_images/math/e3e71b5d34f981d7420bd6361580d8c9204e45c4.png" alt="\sqrt{\text{eV/}(\text{\AA}^2\cdot \text{AMU})}"/> in angular
frequency. To convert this unit to THz (not angular frequency), the
calculation of <code class="docutils literal"><span class="pre">sqrt(EV/AMU)/Angstrom/(2*pi)/1e12</span></code> is made. <code class="docutils literal"><span class="pre">EV</span></code>,
<code class="docutils literal"><span class="pre">AMU</span></code>, <code class="docutils literal"><span class="pre">Angstrom</span></code> are the values to convert them to those in the
SI base unit, i.e., to Joule, kg, and metre, respectively. These values
implemented in phonopy are found at <a class="reference external" href="https://github.com/atztogo/phonopy/blob/master/phonopy/units.py">a phonopy github page</a>. This
unit conversion factor can be manually specified. See
<a class="reference internal" href="setting-tags.html#frequency-conversion-factor-tag"><span class="std std-ref">FREQUENCY_CONVERSION_FACTOR</span></a>.</p>
<p>The unit conversion factor in the <code class="docutils literal"><span class="pre">BORN</span></code> file is multiplied with the second
term of the right hand side of the equation in
<a class="reference internal" href="#non-analytical-term-correction-theory"><span class="std std-ref">Non-analytical term correction</span></a> where this equation is written
with atomic units (<a class="reference internal" href="reference.html#reference-nac"><span class="std std-ref">Gonze and Lee, 1997</span></a>).
The physical unit of the part of the equation corresponding to force
constants:</p>
<div class="math">
<p><img src="_images/math/7cad9d7c14a1c51f1416768610bdeb28a853143a.png" alt="\frac{4\pi}{\Omega_0}
\frac{[\sum_{\gamma}q_{\gamma}Z^{*}_{j,\gamma\alpha}]
[\sum_{\gamma'}q_{\gamma'}Z^{*}_{j',\gamma'\beta}]}
{\sum_{\alpha\beta}q_{\alpha}\epsilon_{\alpha\beta}^{\infty} q_{\beta}}."/></p>
</div><p>is <img class="math" src="_images/math/142cf882644dae869d54b71f914212f4f9ab59b2.png" alt="[\text{hartree}/\text{bohr}^2]"/>. In the default case for the
VASP interface, internally <img class="math" src="_images/math/ed0d9aa2107b3b6d2a148aac8d294a05def42662.png" alt="\Omega_0"/> is given in
<img class="math" src="_images/math/7740b13fb2481ee9a8ea08115b1d75e197181987.png" alt="\text{\AA}^3"/>. In total, the necessary unit conversion is
<img class="math" src="_images/math/9ec0a40e60467b9f67ff4b07a09c4767a8b485e3.png" alt="(\text{hartree} \rightarrow \text{eV}) \times (\text{bohr}
\rightarrow \text{\AA})=14.4"/>. In the default case of the Wien2k
interface, the conversion factor is <img class="math" src="_images/math/9f3ae35cce4ee7ff9c9a4ecf66f7ba2818d1acf4.png" alt="(\text{hartree}
\rightarrow \text{mRy})=2000"/>. For the other interfaces, the
conversion factors are similarly calculated following the unit
systems employed in phonopy (<a class="reference internal" href="interfaces.html#calculator-interfaces"><span class="std std-ref">Interfaces to calculators</span></a>).</p>
</div>
<div class="section" id="commensurate-points">
<span id="definition-of-commensurate-points"></span><h2><a class="toc-backref" href="#id17">Commensurate points</a><a class="headerlink" href="#commensurate-points" title="Permalink to this headline">¶</a></h2>
<p>In phonopy, so-called commensurate points mean the q-points whose waves are
confined in the supercell used in the phonon calculation.</p>
<p>To explain about the commensurate points, let basis vectors of a
primitive cell in direct space cell be the column vectors
<img class="math" src="_images/math/f98aaad19410b96cee910e4857b468ab03858ce3.png" alt="(\mathbf{a}_\mathrm{p} \; \mathbf{b}_\mathrm{p} \;
\mathbf{c}_\mathrm{p})"/> and those of the supercell be
<img class="math" src="_images/math/470207276cb5dbbe15f9928026c849c3244c1d5a.png" alt="(\mathbf{a}_\mathrm{s} \; \mathbf{b}_\mathrm{s} \;
\mathbf{c}_\mathrm{s})"/>. The transformation of the basis vectors from
the primitive cell to the supercell is written as</p>
<div class="math">
<p><img src="_images/math/68d88e54c8e63d8a720eb6539aa80e5bfe0bcb1f.png" alt="( \mathbf{a}_\mathrm{s} \; \mathbf{b}_\mathrm{s} \; \mathbf{c}_\mathrm{s} )
=  ( \mathbf{a}_\mathrm{p} \; \mathbf{b}_\mathrm{p} \;
\mathbf{c}_\mathrm{p} ) \boldsymbol{P}."/></p>
</div><p><img class="math" src="_images/math/11372e1621caf3cb29d878b3ba20f222815fa1d7.png" alt="\boldsymbol{P}"/> is given as a <img class="math" src="_images/math/5e3cfcce6f9932d7aa9d734e989a3976ad13cbff.png" alt="3\times 3"/> matrix and its
elements are all integers, which is a constraint we have. The
resolution for q-points being the commensurate points is determined by
<img class="math" src="_images/math/11372e1621caf3cb29d878b3ba20f222815fa1d7.png" alt="\boldsymbol{P}"/> since one period of a wave has to be bound by
any of lattice points inside the supercell. Therefore the number of
commensurate points becomes the same as the number of the primitive
cell that can be contained in the supercell, i.e.,
<img class="math" src="_images/math/a8e04d7848319a5d4b877e124648d09426510f04.png" alt="\det(\boldsymbol{P})"/>.</p>
<p>Then let the basis vectors in reciprocal space be the column vectors
<img class="math" src="_images/math/4ac4eebe4752a34b7c955b4614e7f0902ffd1f65.png" alt="(\mathbf{a}^*_\mathrm{p} \; \mathbf{b}^*_\mathrm{p} \;
\mathbf{c}^*_\mathrm{p})"/>. Note that often reciprocal vectors are
deifned by row vectors, but column vectors are chosen here to
formulate. Formally we see the set of besis vectors are <img class="math" src="_images/math/91d8e26cff754d01ca438bb7bd49fcfe6270bdbb.png" alt="3\times
3"/> matrices, we have the following relation:</p>
<div class="math">
<p><img src="_images/math/50fcb170947ca61f61b2a8bdc443442624d4e0d2.png" alt="( \mathbf{a}^*_\mathrm{p} \;
\mathbf{b}^*_\mathrm{p} \; \mathbf{c}^*_\mathrm{p} ) = 2\pi (
\mathbf{a}_\mathrm{p} \; \mathbf{b}_\mathrm{p} \;
\mathbf{c}_\mathrm{p} )^{-\mathbf{T}}."/></p>
</div><p>Similarly for the supercell, we define a relation</p>
<div class="math">
<p><img src="_images/math/b19b7a47b02e4258fbf855231c5776f40d683122.png" alt="( \mathbf{a}^*_\mathrm{s} \;
\mathbf{b}^*_\mathrm{s} \; \mathbf{c}^*_\mathrm{s} ) = 2\pi (
\mathbf{a}_\mathrm{s} \; \mathbf{b}_\mathrm{s} \;
\mathbf{c}_\mathrm{s} )^{-\mathbf{T}}."/></p>
</div><p>Then</p>
<div class="math">
<p><img src="_images/math/1ace71f7cadb76b4dd9a8968881088c559cab413.png" alt="( \mathbf{a}^*_\mathrm{s} \; \mathbf{b}^*_\mathrm{s} \;
\mathbf{c}^*_\mathrm{s} ) \boldsymbol{P}^{\mathrm{T}} = (
\mathbf{a}^*_\mathrm{p} \; \mathbf{b}^*_\mathrm{p} \;
\mathbf{c}^*_\mathrm{p} )."/></p>
</div><p>To multiply an arbitrary q-point <img class="math" src="_images/math/9658517ccd5cd64cff63909f92e47b5981b1b2b5.png" alt="\mathbf{q}"/> on both sides</p>
<div class="math">
<p><img src="_images/math/93e7afc6e392becebc047bdf1a97da720a9fae54.png" alt="( \mathbf{a}^*_\mathrm{s} \; \mathbf{b}^*_\mathrm{s} \;
\mathbf{c}^*_\mathrm{s} ) \boldsymbol{P}^{\mathrm{T}} \mathbf{q} = (
\mathbf{a}^*_\mathrm{p} \; \mathbf{b}^*_\mathrm{p} \;
\mathbf{c}^*_\mathrm{p} ) \mathbf{q},"/></p>
</div><p>we find the constraint of a q-point being one of the commensurate points is
the elements of <img class="math" src="_images/math/33db2974e57c0ea83e6523dc453e95541655c58f.png" alt="\boldsymbol{P}^{\mathrm{T}} \mathbf{q}"/> to be integers.</p>
</div>
</div>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
        <br/>
        
<div id="sourcelink">
  <a href="_sources/formulation.rst.txt"
     rel="nofollow">Source</a>
</div>
      
    </p>
    <p>
        &copy; Copyright 2009, Atsushi Togo.<br/>
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.5.4.<br/>
    </p>
  </div>
</footer>
  </body>
</html>