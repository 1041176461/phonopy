<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Quasi harmonic approximation &#8212; Phonopy v.1.14.0</title>
    <link rel="stylesheet" href="_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="_static/bootstrap-3.3.7/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="_static/bootstrap-sphinx.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Interfaces to calculators" href="interfaces.html" />
    <link rel="prev" title="Calculation of mode Grüneisen parameters" href="gruneisen.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">

  </head><body>

  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="index.html">
          Phonopy</a>
        <span class="navbar-text navbar-version pull-left"><b>1.14.0</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="index.html">Site <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><ul class="current">
<li class="toctree-l1"><a class="reference internal" href="install.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="symmetry.html">Crystal symmetry</a></li>
<li class="toctree-l1"><a class="reference internal" href="procedure.html">Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="workflow.html">Work flow</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples.html">Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="input-files.html">Input files</a></li>
<li class="toctree-l1"><a class="reference internal" href="output-files.html">Output files</a></li>
<li class="toctree-l1"><a class="reference internal" href="setting-tags.html">Setting tags</a></li>
<li class="toctree-l1"><a class="reference internal" href="command-options.html">Command options</a></li>
<li class="toctree-l1"><a class="reference internal" href="dynamic-structure-factor.html">Dynamic structure factor</a></li>
<li class="toctree-l1"><a class="reference internal" href="gruneisen.html">Mode Grüneisen parameters</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Quasi harmonic approximation</a></li>
<li class="toctree-l1"><a class="reference internal" href="interfaces.html">Interfaces to calculators</a></li>
<li class="toctree-l1"><a class="reference internal" href="auxiliary-tools.html">Auxiliary tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="external-tools.html">External tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="phonopy-module.html">Phonopy API for Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="formulation.html">Formulations</a></li>
<li class="toctree-l1"><a class="reference internal" href="citation.html">How to cite phonopy</a></li>
<li class="toctree-l1"><a class="reference internal" href="reference.html">References</a></li>
<li class="toctree-l1"><a class="reference internal" href="changelog.html">Change Log</a></li>
</ul>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="documentation.html">Documentation</a></li>
</ul>
</ul>
</li>
              
                <li class="dropdown">
  <a role="button"
     id="dLabelLocalToc"
     data-toggle="dropdown"
     data-target="#"
     href="#">Page <b class="caret"></b></a>
  <ul class="dropdown-menu localtoc"
      role="menu"
      aria-labelledby="dLabelLocalToc"><ul>
<li><a class="reference internal" href="#">Quasi harmonic approximation</a><ul>
<li><a class="reference internal" href="#usage-of-phonopy-qha">Usage of <code class="docutils literal notranslate"><span class="pre">phonopy-qha</span></code></a><ul>
<li><a class="reference internal" href="#options">Options</a><ul>
<li><a class="reference internal" href="#h"><code class="docutils literal notranslate"><span class="pre">-h</span></code></a></li>
<li><a class="reference internal" href="#tmax"><code class="docutils literal notranslate"><span class="pre">--tmax</span></code></a></li>
<li><a class="reference internal" href="#pressure"><code class="docutils literal notranslate"><span class="pre">--pressure</span></code></a></li>
<li><a class="reference internal" href="#b"><code class="docutils literal notranslate"><span class="pre">-b</span></code></a></li>
<li><a class="reference internal" href="#eos"><code class="docutils literal notranslate"><span class="pre">--eos</span></code></a></li>
<li><a class="reference internal" href="#p"><code class="docutils literal notranslate"><span class="pre">-p</span></code></a></li>
<li><a class="reference internal" href="#s"><code class="docutils literal notranslate"><span class="pre">-s</span></code></a></li>
<li><a class="reference internal" href="#sparse"><code class="docutils literal notranslate"><span class="pre">--sparse</span></code></a></li>
<li><a class="reference internal" href="#efe"><code class="docutils literal notranslate"><span class="pre">--efe</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#output-files">Output files</a></li>
</ul>
</li>
<li><a class="reference internal" href="#thermal-properties-in-t-p-space-calculated-under-qha">Thermal properties in (<em>T</em>, <em>p</em>) space calculated under QHA</a></li>
</ul>
</li>
</ul>
</ul>
</li>
              
            
            
              
                
  <li>
    <a href="gruneisen.html" title="Previous Chapter: Calculation of mode Grüneisen parameters"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm hidden-tablet">&laquo; Calculation o...</span>
    </a>
  </li>
  <li>
    <a href="interfaces.html" title="Next Chapter: Interfaces to calculators"><span class="glyphicon glyphicon-chevron-right visible-sm"></span><span class="hidden-sm hidden-tablet">Interfaces to... &raquo;</span>
    </a>
  </li>
              
            
            
            
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="col-md-12 content">
      
  <div class="section" id="quasi-harmonic-approximation">
<span id="phonopy-qha"></span><h1>Quasi harmonic approximation<a class="headerlink" href="#quasi-harmonic-approximation" title="Permalink to this headline">¶</a></h1>
<div class="contents local topic" id="contents">
<ul class="simple">
<li><a class="reference internal" href="#usage-of-phonopy-qha" id="id1">Usage of <code class="docutils literal notranslate"><span class="pre">phonopy-qha</span></code></a><ul>
<li><a class="reference internal" href="#options" id="id2">Options</a></li>
<li><a class="reference internal" href="#output-files" id="id3">Output files</a></li>
</ul>
</li>
<li><a class="reference internal" href="#thermal-properties-in-t-p-space-calculated-under-qha" id="id4">Thermal properties in (<em>T</em>, <em>p</em>) space calculated under QHA</a></li>
</ul>
</div>
<div class="section" id="usage-of-phonopy-qha">
<h2><a class="toc-backref" href="#id1">Usage of <code class="docutils literal notranslate"><span class="pre">phonopy-qha</span></code></a><a class="headerlink" href="#usage-of-phonopy-qha" title="Permalink to this headline">¶</a></h2>
<p>Using phonopy results of thermal properties, thermal expansion and
heat capacity at constant pressure can be calculated under the
quasi-harmonic approximation. <code class="docutils literal notranslate"><span class="pre">phonopy-qha</span></code> is the script to
calculate them. An example of the usage for <code class="docutils literal notranslate"><span class="pre">example/Si-QHA</span></code> is as
follows.</p>
<p>To watch selected plots:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">phonopy</span><span class="o">-</span><span class="n">qha</span> <span class="o">-</span><span class="n">p</span> <span class="n">e</span><span class="o">-</span><span class="n">v</span><span class="o">.</span><span class="n">dat</span> <span class="n">thermal_properties</span><span class="o">.</span><span class="n">yaml</span><span class="o">-</span><span class="p">{</span><span class="o">-</span><span class="p">{</span><span class="mf">5.</span><span class="o">.</span><span class="mi">1</span><span class="p">},{</span><span class="mf">0.</span><span class="o">.</span><span class="mi">5</span><span class="p">}}</span>
</pre></div>
</div>
<div class="figure">
<img alt="_images/Si-QHA.png" src="_images/Si-QHA.png" />
</div>
<p>Without plots:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">phonopy</span><span class="o">-</span><span class="n">qha</span> <span class="n">e</span><span class="o">-</span><span class="n">v</span><span class="o">.</span><span class="n">dat</span> <span class="n">thermal_properties</span><span class="o">.</span><span class="n">yaml</span><span class="o">-</span><span class="p">{</span><span class="o">-</span><span class="p">{</span><span class="mf">5.</span><span class="o">.</span><span class="mi">1</span><span class="p">},{</span><span class="mf">0.</span><span class="o">.</span><span class="mi">5</span><span class="p">}}</span>
</pre></div>
</div>
<p>The first argument is the filename of volume-energy data (in the above
expample, <code class="docutils literal notranslate"><span class="pre">e-v.dat</span></code>). The volumes and energies are given in
<span class="math notranslate nohighlight">\(\text{Angstrom}^3\)</span> and eV, respectively. The energies are only
dependent on volume but not on temperature. Therefore in the simplest
case, these are taken as the electronic total energies at 0K. An
example of the volume-energy file is:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#   cell volume   energy of cell other than phonon</span>
     <span class="mf">140.030000</span>           <span class="o">-</span><span class="mf">42.132246</span>
     <span class="mf">144.500000</span>           <span class="o">-</span><span class="mf">42.600974</span>
     <span class="mf">149.060000</span>           <span class="o">-</span><span class="mf">42.949142</span>
     <span class="mf">153.720000</span>           <span class="o">-</span><span class="mf">43.188162</span>
     <span class="mf">158.470000</span>           <span class="o">-</span><span class="mf">43.326751</span>
     <span class="mf">163.320000</span>           <span class="o">-</span><span class="mf">43.375124</span>
     <span class="mf">168.270000</span>           <span class="o">-</span><span class="mf">43.339884</span>
     <span class="mf">173.320000</span>           <span class="o">-</span><span class="mf">43.230619</span>
     <span class="mf">178.470000</span>           <span class="o">-</span><span class="mf">43.054343</span>
     <span class="mf">183.720000</span>           <span class="o">-</span><span class="mf">42.817825</span>
     <span class="mf">189.070000</span>           <span class="o">-</span><span class="mf">42.527932</span>
</pre></div>
</div>
<p>Lines starting with <code class="docutils literal notranslate"><span class="pre">#</span></code> are ignored.</p>
<p>The following arguments of <code class="docutils literal notranslate"><span class="pre">phonopy-qha</span></code> are the filenames of
<code class="docutils literal notranslate"><span class="pre">thermal_properties.yaml</span></code>’s calculated at the volumes given in the
volume-energy file. These filenames have to be ordered in the same
order as the volumes written in the volume-energy file. Since the
volume v.s. free energy fitting is done at each temperature given in
<code class="docutils literal notranslate"><span class="pre">thermal_properties.yaml</span></code>, all <code class="docutils literal notranslate"><span class="pre">thermal_properties.yaml</span></code>’s have to
be calculated in the same temperature ranges and with the same
temperature step. <code class="docutils literal notranslate"><span class="pre">phonopy-qha</span></code> can calculate thermal properties at
constant pressure up to the temperature point that is one point less
than that in <code class="docutils literal notranslate"><span class="pre">thermal_properties.yaml</span></code> because of the numerical
differentiation with respect to temperature points. Therefore
<code class="docutils literal notranslate"><span class="pre">thermal_properties.yaml</span></code> has to be calculated up to higher
temperatures than that expected by <code class="docutils literal notranslate"><span class="pre">phonopy-qha</span></code>.</p>
<p>Another example for Aluminum is found in the <code class="docutils literal notranslate"><span class="pre">example/Al-QHA</span></code> directory.</p>
<p>If the condition under puressure is expected, <span class="math notranslate nohighlight">\(PV\)</span> terms may be
included in the energies, or equivalent effect is applied using
<code class="docutils literal notranslate"><span class="pre">--pressure</span></code> option.</p>
<p>Experimentally, temperature dependent energies are supported by
<code class="docutils literal notranslate"><span class="pre">--efe</span></code> option. The usage is written at
<a class="reference external" href="https://github.com/atztogo/phonopy/blob/develop/example/Cu-QHA/README">https://github.com/atztogo/phonopy/blob/develop/example/Cu-QHA/README</a>.</p>
<div class="section" id="options">
<span id="phonopy-qha-options"></span><h3><a class="toc-backref" href="#id2">Options</a><a class="headerlink" href="#options" title="Permalink to this headline">¶</a></h3>
<div class="section" id="h">
<h4><code class="docutils literal notranslate"><span class="pre">-h</span></code><a class="headerlink" href="#h" title="Permalink to this headline">¶</a></h4>
<p>Show help. The available options are shown. Without any option, the
results are saved into text files in simple data format.</p>
</div>
<div class="section" id="tmax">
<h4><code class="docutils literal notranslate"><span class="pre">--tmax</span></code><a class="headerlink" href="#tmax" title="Permalink to this headline">¶</a></h4>
<p>The maximum temperature calculated is specified. This temperature has
to be lower than the maximum temperature calculated in
<code class="docutils literal notranslate"><span class="pre">thermal_properties.yaml</span></code> to let at least one temperature points
fewer. The default value is <code class="docutils literal notranslate"><span class="pre">--tmax=1000</span></code>.</p>
</div>
<div class="section" id="pressure">
<h4><code class="docutils literal notranslate"><span class="pre">--pressure</span></code><a class="headerlink" href="#pressure" title="Permalink to this headline">¶</a></h4>
<p>Pressure is specified in GPa. This corresponds to the <span class="math notranslate nohighlight">\(pV\)</span> term
described in the following section <a class="reference internal" href="#theory-of-qha"><span class="std std-ref">Thermal properties in (T, p) space calculated under QHA</span></a>. Note that
bulk modulus obtained with this option than 0 GPa is incorrect.</p>
</div>
<div class="section" id="b">
<h4><code class="docutils literal notranslate"><span class="pre">-b</span></code><a class="headerlink" href="#b" title="Permalink to this headline">¶</a></h4>
<p>Fitting volume-energy data to an EOS, and show bulk
modulus (without considering phonons). This is made by:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">%</span> <span class="n">phonopy</span><span class="o">-</span><span class="n">qha</span> <span class="o">-</span><span class="n">b</span> <span class="n">e</span><span class="o">-</span><span class="n">v</span><span class="o">.</span><span class="n">dat</span>
</pre></div>
</div>
</div>
<div class="section" id="eos">
<h4><code class="docutils literal notranslate"><span class="pre">--eos</span></code><a class="headerlink" href="#eos" title="Permalink to this headline">¶</a></h4>
<p>EOS is chosen among <code class="docutils literal notranslate"><span class="pre">vinet</span></code>, <code class="docutils literal notranslate"><span class="pre">birch_murnaghan</span></code>, and
<code class="docutils literal notranslate"><span class="pre">murnaghan</span></code>. The default EOS is <code class="docutils literal notranslate"><span class="pre">vinet</span></code>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">%</span> <span class="n">phonopy</span><span class="o">-</span><span class="n">qha</span> <span class="o">--</span><span class="n">eos</span><span class="o">=</span><span class="s1">&#39;birch_murnaghan&#39;</span> <span class="o">-</span><span class="n">b</span> <span class="n">e</span><span class="o">-</span><span class="n">v</span><span class="o">.</span><span class="n">dat</span>
</pre></div>
</div>
</div>
<div class="section" id="p">
<h4><code class="docutils literal notranslate"><span class="pre">-p</span></code><a class="headerlink" href="#p" title="Permalink to this headline">¶</a></h4>
<p>The fitting results, volume-temperature relation, and thermal expansion
coefficient are plotted on the display.</p>
</div>
<div class="section" id="s">
<h4><code class="docutils literal notranslate"><span class="pre">-s</span></code><a class="headerlink" href="#s" title="Permalink to this headline">¶</a></h4>
<p>The calculated values are written into files.</p>
</div>
<div class="section" id="sparse">
<h4><code class="docutils literal notranslate"><span class="pre">--sparse</span></code><a class="headerlink" href="#sparse" title="Permalink to this headline">¶</a></h4>
<p>This is used with <code class="docutils literal notranslate"><span class="pre">-s</span></code> or <code class="docutils literal notranslate"><span class="pre">-p</span></code> to thin out the number of plots of
the fitting results at temperatures. For example with <code class="docutils literal notranslate"><span class="pre">--sparse=10</span></code>,
1 in 10 temperature curves is only plotted.</p>
</div>
<div class="section" id="efe">
<span id="phonopy-qha-efe-option"></span><h4><code class="docutils literal notranslate"><span class="pre">--efe</span></code><a class="headerlink" href="#efe" title="Permalink to this headline">¶</a></h4>
<p><strong>Experimental</strong></p>
<p>Temperature dependent energies other than phonon free energy are
included with this option. This is used such as:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">%</span> <span class="n">phonopy</span><span class="o">-</span><span class="n">qha</span> <span class="o">-</span><span class="n">p</span> <span class="o">--</span><span class="n">tmax</span><span class="o">=</span><span class="mi">1300</span> <span class="o">--</span><span class="n">efe</span> <span class="n">fe</span><span class="o">-</span><span class="n">v</span><span class="o">.</span><span class="n">dat</span> <span class="n">e</span><span class="o">-</span><span class="n">v</span><span class="o">.</span><span class="n">dat</span> <span class="n">thermal_properties</span><span class="o">.</span><span class="n">yaml</span><span class="o">-</span><span class="p">{</span><span class="mf">00.</span><span class="o">.</span><span class="mi">10</span><span class="p">}</span>
</pre></div>
</div>
<div class="figure">
<img alt="_images/Cu-QHA.png" src="_images/Cu-QHA.png" />
</div>
<p>The temperature dependent energies are stored in <code class="docutils literal notranslate"><span class="pre">fe-v.dat</span></code>. The
file format is:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># volume:       43.08047896     43.97798894     44.87549882     45.77300889     46.67051887     47.56802885     48.46553883     49.36304881     50.26055878     51.15806876     52.05557874</span>
<span class="c1">#    T(K)     Free energies</span>
    <span class="mf">0.0000</span>     <span class="o">-</span><span class="mf">17.27885993</span>    <span class="o">-</span><span class="mf">17.32227490</span>    <span class="o">-</span><span class="mf">17.34336569</span>    <span class="o">-</span><span class="mf">17.34479760</span>    <span class="o">-</span><span class="mf">17.32843604</span>    <span class="o">-</span><span class="mf">17.29673896</span>    <span class="o">-</span><span class="mf">17.25081954</span>    <span class="o">-</span><span class="mf">17.19263337</span>    <span class="o">-</span><span class="mf">17.12356816</span>    <span class="o">-</span><span class="mf">17.04467997</span>    <span class="o">-</span><span class="mf">16.95752155</span>
   <span class="mf">10.0000</span>     <span class="o">-</span><span class="mf">17.27886659</span>    <span class="o">-</span><span class="mf">17.32228126</span>    <span class="o">-</span><span class="mf">17.34337279</span>    <span class="o">-</span><span class="mf">17.34481060</span>    <span class="o">-</span><span class="mf">17.32844885</span>    <span class="o">-</span><span class="mf">17.29675204</span>    <span class="o">-</span><span class="mf">17.25083261</span>    <span class="o">-</span><span class="mf">17.19264615</span>    <span class="o">-</span><span class="mf">17.12358094</span>    <span class="o">-</span><span class="mf">17.04469309</span>    <span class="o">-</span><span class="mf">16.95753464</span>
   <span class="mf">20.0000</span>     <span class="o">-</span><span class="mf">17.27887453</span>    <span class="o">-</span><span class="mf">17.32228804</span>    <span class="o">-</span><span class="mf">17.34338499</span>    <span class="o">-</span><span class="mf">17.34482383</span>    <span class="o">-</span><span class="mf">17.32846353</span>    <span class="o">-</span><span class="mf">17.29676491</span>    <span class="o">-</span><span class="mf">17.25084547</span>    <span class="o">-</span><span class="mf">17.19265900</span>    <span class="o">-</span><span class="mf">17.12359399</span>    <span class="o">-</span><span class="mf">17.04470709</span>    <span class="o">-</span><span class="mf">16.95754774</span>
<span class="o">...</span>
</pre></div>
</div>
<p>This file doesn’t contain the information about cell volumes that are
obtained from <code class="docutils literal notranslate"><span class="pre">e-v.dat</span></code> file though the energy data in <code class="docutils literal notranslate"><span class="pre">e-v.dat</span></code>
are not used. In <code class="docutils literal notranslate"><span class="pre">fe-v.dat</span></code>, the lines starting with <code class="docutils literal notranslate"><span class="pre">#</span></code> are
ignored. Rows and columns are the temperature and volume axes. The
first column gives temperatures. The following columns give the
temperature dependent energies.The temperature points are expected to
be the same as those in <code class="docutils literal notranslate"><span class="pre">thermal_properties.yaml</span></code> at least up to the
maximum temperature specified for <code class="docutils literal notranslate"><span class="pre">phonopy-qha</span></code>.</p>
<p>An example is given in <code class="docutils literal notranslate"><span class="pre">example/Cu-QHA</span></code>. The <code class="docutils literal notranslate"><span class="pre">fe-v.dat</span></code> contains
electronic free energy calculated following, e.g., Eqs. (11) and (12)
in the paper by Wolverton and Zunger, Phys. Rev. B, <strong>52</strong>, 8813
(1994) (of course this paper is not the first one that showed these
equations):</p>
<div class="math notranslate nohighlight">
\[S_\text{el}(V) = -gk_{\mathrm{B}}\Sigma_i \{ f_i(V) \ln f_i(V) +
[1-f_i(V)]\ln [1-f_i(V)] \}\]</div>
<p>with</p>
<div class="math notranslate nohighlight">
\[f_i(V) = \left\{ 1 + \exp\left[\frac{\epsilon_i(V) - \mu(V)}{T}\right] \right\}^{-1}\]</div>
<p>and</p>
<div class="math notranslate nohighlight">
\[E_\text{el}(V) = g\sum_i f_i(V) \epsilon_i(V),\]</div>
<p>where <span class="math notranslate nohighlight">\(g\)</span> is 1 or 2 for collinear spin polarized and non-spin
polarized systems, respectively. For VASP, a script to create
<code class="docutils literal notranslate"><span class="pre">fe-v.dat</span></code> and <code class="docutils literal notranslate"><span class="pre">e-v.dat</span></code> by these equations is prepared as
<code class="docutils literal notranslate"><span class="pre">phonopy-vasp-efe</span></code>, which is used as:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">%</span> <span class="n">phonopy</span><span class="o">-</span><span class="n">vasp</span><span class="o">-</span><span class="n">efe</span> <span class="o">--</span><span class="n">tmax</span><span class="o">=</span><span class="mi">1500</span> <span class="n">vasprun</span><span class="o">.</span><span class="n">xml</span><span class="o">-</span><span class="p">{</span><span class="mf">00.</span><span class="o">.</span><span class="mi">10</span><span class="p">}</span>
</pre></div>
</div>
<p>where <code class="docutils literal notranslate"><span class="pre">vasprun.xml-{00..10}</span></code> have to be computed for the same unit
cells as those used for <code class="docutils literal notranslate"><span class="pre">thermal_properties.yaml</span></code>.  When <code class="docutils literal notranslate"><span class="pre">phonopy</span></code>
was run with <code class="docutils literal notranslate"><span class="pre">PRIMITIVE_AXES</span></code> or <code class="docutils literal notranslate"><span class="pre">--pa</span></code> option, the unit cells for
computing electronic eigenvalues have to be carefully chosen to agree
with those after applying <code class="docutils literal notranslate"><span class="pre">PRIMITIVE_AXES</span></code>, or energies are scaled a
posteriori.</p>
</div>
</div>
<div class="section" id="output-files">
<span id="phonopy-qha-output-files"></span><h3><a class="toc-backref" href="#id3">Output files</a><a class="headerlink" href="#output-files" title="Permalink to this headline">¶</a></h3>
<p>The physical units of V and T are <span class="math notranslate nohighlight">\(\text{Angstrom}^3\)</span> and K,
respectively. The unit of eV for Helmholtz and Gibbs energies, J/K/mol
for <span class="math notranslate nohighlight">\(C_V\)</span> and entropy, GPa for for bulk modulus and pressure
are used.</p>
<ul class="simple">
<li>Bulk modulus <span class="math notranslate nohighlight">\(B_T\)</span> (GPa) vs <span class="math notranslate nohighlight">\(T\)</span> (<code class="docutils literal notranslate"><span class="pre">bulk_modulus-temperature.*</span></code>)</li>
<li>Gibbs free energy <span class="math notranslate nohighlight">\(G\)</span> (eV) vs <span class="math notranslate nohighlight">\(T\)</span> (<code class="docutils literal notranslate"><span class="pre">gibbs-temperature.*</span></code>)</li>
<li>Heat capacity at constant pressure <span class="math notranslate nohighlight">\(C_p\)</span> (J/K/mol) vs
<span class="math notranslate nohighlight">\(T\)</span> computed by <span class="math notranslate nohighlight">\(-T\frac{\partial^2 G}{\partial T^2}\)</span>
from three <span class="math notranslate nohighlight">\(G(T)\)</span> points (<code class="docutils literal notranslate"><span class="pre">Cp-temperature.*</span></code>)</li>
<li>Heat capacity at constant puressure <span class="math notranslate nohighlight">\(C_p\)</span> (J/K/mol) vs
<span class="math notranslate nohighlight">\(T\)</span> computed by polynomial fittings of <span class="math notranslate nohighlight">\(C_V(V)\)</span>
(<code class="docutils literal notranslate"><span class="pre">Cv-volume.dat</span></code>) and <span class="math notranslate nohighlight">\(S(V)\)</span> (<code class="docutils literal notranslate"><span class="pre">entropy-volume.dat</span></code>) for
<span class="math notranslate nohighlight">\(\partial S/\partial V\)</span> (<code class="docutils literal notranslate"><span class="pre">dsdv-temperature.dat</span></code>) and
numerical differentiation of <span class="math notranslate nohighlight">\(\partial V/\partial T\)</span>, e.g., see
Eq.(5) of PRB <strong>81</strong>, 174301 by Togo <em>et al.</em>
(<code class="docutils literal notranslate"><span class="pre">Cp-temperature_polyfit.*</span></code>).
This may give smoother <span class="math notranslate nohighlight">\(C_p\)</span> than that from
<span class="math notranslate nohighlight">\(-T\frac{\partial^2 G}{\partial T^2}\)</span>.</li>
<li>Volumetric thermal expansion coefficient <span class="math notranslate nohighlight">\(\beta\)</span> vs <span class="math notranslate nohighlight">\(T\)</span>
computed by numerical differentiation (<code class="docutils literal notranslate"><span class="pre">thermal_expansion.*</span></code>)</li>
<li>Volume vs <span class="math notranslate nohighlight">\(T\)</span> (<code class="docutils literal notranslate"><span class="pre">volume-temperature.*</span></code>)</li>
<li>Thermodynamics Grüneisen parameter <span class="math notranslate nohighlight">\(\gamma = V\beta B_T/C_V\)</span>
(no unit) vs <span class="math notranslate nohighlight">\(T\)</span> (<code class="docutils literal notranslate"><span class="pre">gruneisen-temperature.dat</span></code>)</li>
<li>Helmholtz free energy (eV) vs volume
(<code class="docutils literal notranslate"><span class="pre">helmholtz-volume.*</span></code>). When <code class="docutils literal notranslate"><span class="pre">--pressure</span></code> option is specified,
energy offset of <span class="math notranslate nohighlight">\(pV\)</span> is added. See also the following section
(<a class="reference internal" href="#theory-of-qha"><span class="std std-ref">Thermal properties in (T, p) space calculated under QHA</span></a>).</li>
</ul>
</div>
</div>
<div class="section" id="thermal-properties-in-t-p-space-calculated-under-qha">
<span id="theory-of-qha"></span><h2><a class="toc-backref" href="#id4">Thermal properties in (<em>T</em>, <em>p</em>) space calculated under QHA</a><a class="headerlink" href="#thermal-properties-in-t-p-space-calculated-under-qha" title="Permalink to this headline">¶</a></h2>
<p>Here the word ‘quasi-harmonic approximation’ is used for an
approximation that introduces volume dependence of phonon frequencies
as a part of anharmonic effect.</p>
<p>A part of temperature effect can be included into total energy of
electronic structure through phonon (Helmholtz) free energy at
constant volume. But what we want to know is thermal properties at
constant pressure. We need some transformation from function of <em>V</em> to
function of <em>p</em>. Gibbs free energy is defined at a constant pressure by
the transformation:</p>
<div class="math notranslate nohighlight">
\[G(T, p) = \min_V \left[ U(V) + F_\mathrm{phonon}(T;\,V) + pV \right],\]</div>
<p>where</p>
<div class="math notranslate nohighlight">
\[\min_V[ \text{function of } V ]\]</div>
<p>means to find unique minimum value in the brackets by changing
volume. Since volume dependencies of energies in electronic and phonon
structures are different, volume giving the minimum value of the
energy function in the square brackets shifts from the value
calculated only from electronic structure even at 0 K. By increasing
temperature, the volume dependence of phonon free energy changes, then
the equilibrium volume at temperatures changes. This is considered as
thermal expansion under this approximation.</p>
<p><code class="docutils literal notranslate"><span class="pre">phonopy-qha</span></code> collects the values at volumes and transforms into the
thermal properties at constant pressure.</p>
</div>
</div>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
        <br/>
        
<div id="sourcelink">
  <a href="_sources/qha.rst.txt"
     rel="nofollow">Source</a>
</div>
      
    </p>
    <p>
        &copy; Copyright 2009, Atsushi Togo.<br/>
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.8.1.<br/>
    </p>
  </div>
</footer>
  </body>
</html>