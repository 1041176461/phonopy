<!DOCTYPE html>


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Mean square displacement &#8212; Phonopy v.1.11.6</title>
    
    <link rel="stylesheet" href="_static/basic.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/bootswatch-3.3.6/cosmo/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" href="_static/bootstrap-sphinx.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '1.11.6',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="_static/bootstrap-3.3.6/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="_static/bootstrap-sphinx.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="top" title="Phonopy v.1.11.6" href="index.html" />
    <link rel="up" title="Formulations" href="formulation.html" />
    <link rel="next" title="Method" href="group-velocity.html" />
    <link rel="prev" title="Formulations" href="formulation.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">

  </head>
  <body role="document">

  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="index.html">
          Phonopy</a>
        <span class="navbar-text navbar-version pull-left"><b>1.11.6</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="index.html">Site <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><ul class="current">
<li class="toctree-l1"><a class="reference internal" href="examples.html">Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="procedure.html">Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="workflow.html">Work flow</a></li>
<li class="toctree-l1"><a class="reference internal" href="install.html">Download and install</a></li>
<li class="toctree-l1"><a class="reference internal" href="features.html">Features</a></li>
<li class="toctree-l1"><a class="reference internal" href="input-files.html">Input files</a></li>
<li class="toctree-l1"><a class="reference internal" href="output-files.html">Output files</a></li>
<li class="toctree-l1"><a class="reference internal" href="setting-tags.html">Setting tags</a></li>
<li class="toctree-l1"><a class="reference internal" href="command-options.html">Command options</a></li>
<li class="toctree-l1"><a class="reference internal" href="qha.html">Quasi harmonic approximation</a></li>
<li class="toctree-l1"><a class="reference internal" href="gruneisen.html">Mode Grüneisen parameters</a></li>
<li class="toctree-l1"><a class="reference internal" href="interfaces.html">Interfaces to calculators</a></li>
<li class="toctree-l1"><a class="reference internal" href="auxiliary-tools.html">Auxiliary tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="external-tools.html">External tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="phonopy-module.html">Using phonopy as a python module</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="formulation.html">Formulations</a></li>
<li class="toctree-l1"><a class="reference internal" href="citation.html">How to cite phonopy</a></li>
<li class="toctree-l1"><a class="reference internal" href="reference.html">References</a></li>
<li class="toctree-l1"><a class="reference internal" href="changelog.html">Change Log</a></li>
</ul>
</ul>
</li>
              
                <li class="dropdown">
  <a role="button"
     id="dLabelLocalToc"
     data-toggle="dropdown"
     data-target="#"
     href="#">Page <b class="caret"></b></a>
  <ul class="dropdown-menu localtoc"
      role="menu"
      aria-labelledby="dLabelLocalToc"><ul>
<li><a class="reference internal" href="#">Mean square displacement</a></li>
<li><a class="reference internal" href="#mean-square-displacement-matrix">Mean square displacement matrix</a></li>
<li><a class="reference internal" href="#projection-to-an-arbitrary-axis-from-the-cartesian-axes">Projection to an arbitrary axis from the Cartesian axes</a></li>
<li><a class="reference internal" href="#mean-square-displacement-matrix-in-cif-format">Mean square displacement matrix in cif format</a></li>
</ul>
</ul>
</li>
              
            
            
              
                
  <li>
    <a href="formulation.html" title="Previous Chapter: Formulations"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm hidden-tablet">&laquo; Formulations</span>
    </a>
  </li>
  <li>
    <a href="group-velocity.html" title="Next Chapter: Method"><span class="glyphicon glyphicon-chevron-right visible-sm"></span><span class="hidden-sm hidden-tablet">Method &raquo;</span>
    </a>
  </li>
              
            
            
            
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="col-md-12 content">
      
  <div class="section" id="mean-square-displacement">
<span id="thermal-displacement"></span><h1>Mean square displacement<a class="headerlink" href="#mean-square-displacement" title="Permalink to this headline">¶</a></h1>
<p>From Eq. (10.71) in the book &#8220;Thermodynamics of Crystal&#8221;, atomic
displacement, <strong>u</strong>, is written by</p>
<div class="math">
<p><img src="_images/math/cd140275f82317f9244e857ca0bc4b1db5dbe007.png" alt="u^\alpha(jl,t) = \left(\frac{\hbar}{2Nm_j}\right)^{\frac{1}{2}}
\sum_{\mathbf{q},\nu}\left[\omega_\nu(\mathbf{q})\right]^{-\frac{1}{2}}
\left[\hat{a}_\nu(\mathbf{q})\exp(-i\omega_\nu(\mathbf{q})t)+
\hat{a}^\dagger_\nu(\mathbf{-q})\exp({i\omega_\nu(\mathbf{q})}t)\right]
\exp({i\mathbf{q}\cdot\mathbf{r}(jl)})
e^\alpha_\nu(j,\mathbf{q})"/></p>
</div><p>where <em>j</em> and <em>l</em> are the labels for the <em>j</em>-th atomic position in the
<em>l</em>-th unit cell, <em>t</em> is the time, <img class="math" src="_images/math/877d234f4cec6974ce218fc2e975a486a7972dfd.png" alt="\alpha"/> is an axis (a
Cartesian axis in the default behavior of phonopy), <em>m</em> is the atomic
mass, <em>N</em> is the number of the unit cells, <img class="math" src="_images/math/9658517ccd5cd64cff63909f92e47b5981b1b2b5.png" alt="\mathbf{q}"/> is the
wave vector, <img class="math" src="_images/math/ca3b8fa4180eee2dfc3af9d13fae1da451cd2c31.png" alt="\nu"/> is the index of phonon mode. <em>e</em> is the
polarization vector of the atom <em>jl</em> and the band <img class="math" src="_images/math/ca3b8fa4180eee2dfc3af9d13fae1da451cd2c31.png" alt="\nu"/> at
<img class="math" src="_images/math/9658517ccd5cd64cff63909f92e47b5981b1b2b5.png" alt="\mathbf{q}"/>. <img class="math" src="_images/math/0c1332a41052512298350527298ed5d047f654b2.png" alt="\mathbf{r}(jl)"/> is the atomic position and
<img class="math" src="_images/math/b51aa99e0bc8cc8c3d17c0b9cf822db73e13293e.png" alt="\omega"/> is the phonon frequency. <img class="math" src="_images/math/7137b77e7927f934524e5a463e92a87d9c19fee4.png" alt="\hat{a}^\dagger"/> and
<img class="math" src="_images/math/8d6498cc51196a2e38f403d0e4cf0a236f88531a.png" alt="\hat{a}"/> are the creation and annihilation operators of
phonon. The expectation value of the squared atomic displacement is
calculated as,</p>
<div class="math">
<p><img src="_images/math/9cdf0bfd028d9782b36b3e9d8d5a5fa47c14aa6a.png" alt="\left\langle |u^\alpha(jl, t)|^2 \right\rangle = \frac{\hbar}{2Nm_j}
\sum_{\mathbf{q},\nu}\omega_\nu(\mathbf{q})^{-1}
(1+2n_\nu(\mathbf{q},T))|e^\alpha_\nu(j,\mathbf{q})|^2,"/></p>
</div><p>where <img class="math" src="_images/math/3694352ecca446650a790a290d8817cdc0f61e19.png" alt="n_\nu(\mathbf{q},T)"/> is the phonon population, which is give by,</p>
<div class="math">
<p><img src="_images/math/af598e6e252cf0a40c2373ddf5b23c8c4a9f3a64.png" alt="n_\nu(\mathbf{q},T) =
\frac{1}{\exp(\hbar\omega_\nu(\mathbf{q})/\mathrm{k_B}T)-1},"/></p>
</div><p>where <em>T</em> is the temperature, and <img class="math" src="_images/math/c435b7d335440cdec55adc8015f38ce11e932217.png" alt="\mathrm{k_B}"/> is the
Boltzmann constant. The equation is calculated using the commutation
relation of the creation and annihilation operators and the
expectation values of the combination of the operations, e.g.,</p>
<div class="math">
<p><img src="_images/math/aa1358902404d905e6f986d948fd6fc0727dda03.png" alt="[ \hat{a}_\nu(\mathbf{q}), \hat{a}^\dagger_{\nu'}(\mathbf{q'}) ]
= \delta(\mathbf{q}-\mathbf{q}')\delta_{\nu\nu'},

[ \hat{a}_\nu(\mathbf{q}), \hat{a}_{\nu'}(\mathbf{q'}) ] = 0,

[ \hat{a}^\dagger_\nu(\mathbf{q}), \hat{a}^\dagger_{\nu'}(\mathbf{q'}) ] = 0,

\langle|\hat{a}_\nu(\mathbf{q})\hat{a}_{\nu'}(\mathbf{q'})|\rangle
= 0,

\langle|\hat{a}^\dagger_\nu(\mathbf{q})\hat{a}^\dagger_{\nu'}(\mathbf{q'})|\rangle
= 0."/></p>
</div></div>
<div class="section" id="mean-square-displacement-matrix">
<span id="thermal-displacement-matrix"></span><h1>Mean square displacement matrix<a class="headerlink" href="#mean-square-displacement-matrix" title="Permalink to this headline">¶</a></h1>
<p>Mean square displacement matrix is defined as follows:</p>
<div class="math">
<p><img src="_images/math/76376db6e6dfd733945849392d2276906935aa17.png" alt="\mathrm{U}_\text{cart}(j, T) = \frac{\hbar}{2Nm_j}
\sum_{\mathbf{q},\nu}\omega_\nu(\mathbf{q},T)^{-1}
(1+2n_\nu(\mathbf{q}))
\mathbf{e}_\nu(j,\mathbf{q}) \otimes \mathbf{e}^*_\nu(j,\mathbf{q})."/></p>
</div><p>This is a symmetry matrix and diagonal elements are same as mean
square displacement calculated along Cartesian x, y, z directions.</p>
</div>
<div class="section" id="projection-to-an-arbitrary-axis-from-the-cartesian-axes">
<h1>Projection to an arbitrary axis from the Cartesian axes<a class="headerlink" href="#projection-to-an-arbitrary-axis-from-the-cartesian-axes" title="Permalink to this headline">¶</a></h1>
<p>In phonopy, eigenvectors are calculated in the Cartesian axes that are
defined in the input structure file. Mean square displacement along an
arbitrary axis is obtained projecting eigenvectors in the Cartesian
axes as follows:</p>
<div class="math">
<p><img src="_images/math/8da0bce5108405e4862a3538e8755063884f5c04.png" alt="\left\langle |u(jl, t)|^2 \right\rangle = \frac{\hbar}{2Nm_j}
\sum_{\mathbf{q},\nu}\omega_\nu(\mathbf{q})^{-1}
(1+2n_\nu(\mathbf{q}))|
\hat{\mathbf{n}}\cdot\mathbf{e}_\nu(j,\mathbf{q})|^2"/></p>
</div><p>where <img class="math" src="_images/math/478876c4be3d80f295d2eff116c1ca1db7eeabec.png" alt="\hat{\mathbf{n}}"/> is an arbitrary unit direction.</p>
</div>
<div class="section" id="mean-square-displacement-matrix-in-cif-format">
<h1>Mean square displacement matrix in cif format<a class="headerlink" href="#mean-square-displacement-matrix-in-cif-format" title="Permalink to this headline">¶</a></h1>
<p>According to the paper by Grosse-Kunstleve and Adams [J. Appl. Cryst.,
35, 477-480 (2002)], mean square displacement matrix in the cif
definition (<code class="docutils literal"><span class="pre">aniso_U</span></code>),
<img class="math" src="_images/math/b72ca23df3499e7e1df096fd8b1956164fb947bb.png" alt="\mathrm{U}_\text{cif}"/>, is obtained by</p>
<div class="math">
<p><img src="_images/math/7806495f87988bc46eaf246a0399dea8748be6ad.png" alt="\mathrm{U}_\text{cif} = (\mathrm{AN})^{-1}\mathrm{U}_\text{cart}
(\mathrm{AN})^{-\mathrm{T}},"/></p>
</div><p>where <img class="math" src="_images/math/c7d424a23b54e47c8f38437be72671fb0f789201.png" alt="\mathrm{A}"/> is the matrix to transform a point in fractional
coordinates to the Cartesian coordinates and <img class="math" src="_images/math/5324221299528e62425a57c0674516e3b149e100.png" alt="\mathrm{N}"/> is the
diagonal matrix made of reciprocal basis vector lengths as follows:</p>
<div class="math">
<p><img src="_images/math/3f3c9b74f13abc866ae667d928f46e4cdbbe284e.png" alt="\mathrm{A} = \begin{pmatrix}
a_x &amp; b_x &amp; c_x \\
a_y &amp; b_y &amp; c_y \\
a_z &amp; b_z &amp; c_z
\end{pmatrix}"/></p>
</div><p>and</p>
<div class="math">
<p><img src="_images/math/4229643d51642b87abfdae8b1b61f623e1bcc590.png" alt="\mathrm{N} = \begin{pmatrix}
a^* &amp; 0 &amp; 0 \\
0 &amp; b^* &amp; 0 \\
0 &amp; 0 &amp; c^*
\end{pmatrix}."/></p>
</div><p><img class="math" src="_images/math/f8c09bb8fa9507824f5d0ffa11542c5fefa5c41b.png" alt="a^*"/>, <img class="math" src="_images/math/f90f3b0b1161b8b322e4540a68dac93b46a6a3e9.png" alt="b^*"/>, <img class="math" src="_images/math/fd688c7724c647ecb19565e49e59adcb46965359.png" alt="c^*"/> are defined without <img class="math" src="_images/math/6f064faadf14a1d739a4ca4e1ea4aeeb3a342dfe.png" alt="2\pi"/>.</p>
</div>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
        <br/>
        
<div id="sourcelink">
  <a href="_sources/thermal-displacement.txt"
     rel="nofollow">Source</a>
</div>
      
    </p>
    <p>
        &copy; Copyright 2009, Atsushi Togo.<br/>
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.4.8.<br/>
    </p>
  </div>
</footer>
  </body>
</html>