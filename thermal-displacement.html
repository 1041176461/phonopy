<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Mean square displacement &#8212; Phonopy v.1.11.14</title>
    
    <link rel="stylesheet" href="_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '1.11.14',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="_static/bootstrap-3.3.7/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="_static/bootstrap-sphinx.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Method" href="group-velocity.html" />
    <link rel="prev" title="Formulations" href="formulation.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">

  </head>
  <body>

  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="index.html">
          Phonopy</a>
        <span class="navbar-text navbar-version pull-left"><b>1.11.14</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="index.html">Site <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><ul class="current">
<li class="toctree-l1"><a class="reference internal" href="install.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="symmetry.html">Crystal symmetry</a></li>
<li class="toctree-l1"><a class="reference internal" href="procedure.html">Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="workflow.html">Work flow</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples.html">Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="input-files.html">Input files</a></li>
<li class="toctree-l1"><a class="reference internal" href="output-files.html">Output files</a></li>
<li class="toctree-l1"><a class="reference internal" href="setting-tags.html">Setting tags</a></li>
<li class="toctree-l1"><a class="reference internal" href="command-options.html">Command options</a></li>
<li class="toctree-l1"><a class="reference internal" href="qha.html">Quasi harmonic approximation</a></li>
<li class="toctree-l1"><a class="reference internal" href="gruneisen.html">Mode Grüneisen parameters</a></li>
<li class="toctree-l1"><a class="reference internal" href="interfaces.html">Interfaces to calculators</a></li>
<li class="toctree-l1"><a class="reference internal" href="auxiliary-tools.html">Auxiliary tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="external-tools.html">External tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="phonopy-module.html">Using phonopy as a python module</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="formulation.html">Formulations</a></li>
<li class="toctree-l1"><a class="reference internal" href="citation.html">How to cite phonopy</a></li>
<li class="toctree-l1"><a class="reference internal" href="reference.html">References</a></li>
<li class="toctree-l1"><a class="reference internal" href="changelog.html">Change Log</a></li>
</ul>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="documentation.html">Documentation</a></li>
</ul>
</ul>
</li>
              
                <li class="dropdown">
  <a role="button"
     id="dLabelLocalToc"
     data-toggle="dropdown"
     data-target="#"
     href="#">Page <b class="caret"></b></a>
  <ul class="dropdown-menu localtoc"
      role="menu"
      aria-labelledby="dLabelLocalToc"><ul>
<li><a class="reference internal" href="#">Mean square displacement</a></li>
<li><a class="reference internal" href="#mean-square-displacement-matrix">Mean square displacement matrix</a></li>
<li><a class="reference internal" href="#projection-to-an-arbitrary-axis-from-the-cartesian-axes">Projection to an arbitrary axis from the Cartesian axes</a></li>
<li><a class="reference internal" href="#mean-square-displacement-matrix-in-cif-format">Mean square displacement matrix in cif format</a></li>
</ul>
</ul>
</li>
              
            
            
              
                
  <li>
    <a href="formulation.html" title="Previous Chapter: Formulations"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm hidden-tablet">&laquo; Formulations</span>
    </a>
  </li>
  <li>
    <a href="group-velocity.html" title="Next Chapter: Method"><span class="glyphicon glyphicon-chevron-right visible-sm"></span><span class="hidden-sm hidden-tablet">Method &raquo;</span>
    </a>
  </li>
              
            
            
            
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="col-md-12 content">
      
  <div class="section" id="mean-square-displacement">
<span id="thermal-displacement"></span><h1>Mean square displacement<a class="headerlink" href="#mean-square-displacement" title="Permalink to this headline">¶</a></h1>
<p>From Eq. (10.71) in the book “Thermodynamics of Crystal”, atomic
displacement, <strong>u</strong>, is written by</p>
<div class="math">
\[u^\alpha(jl,t) = \left(\frac{\hbar}{2Nm_j}\right)^{\frac{1}{2}}
\sum_{\mathbf{q},\nu}\left[\omega_\nu(\mathbf{q})\right]^{-\frac{1}{2}}
\left[\hat{a}_\nu(\mathbf{q})\exp(-i\omega_\nu(\mathbf{q})t)+
\hat{a}^\dagger_\nu(\mathbf{-q})\exp({i\omega_\nu(\mathbf{q})}t)\right]
\exp({i\mathbf{q}\cdot\mathbf{r}(jl)})
e^\alpha_\nu(j,\mathbf{q})\]</div>
<p>where <em>j</em> and <em>l</em> are the labels for the <em>j</em>-th atomic position in the
<em>l</em>-th unit cell, <em>t</em> is the time, <span class="math">\(\alpha\)</span> is an axis (a
Cartesian axis in the default behavior of phonopy), <em>m</em> is the atomic
mass, <em>N</em> is the number of the unit cells, <span class="math">\(\mathbf{q}\)</span> is the
wave vector, <span class="math">\(\nu\)</span> is the index of phonon mode. <em>e</em> is the
polarization vector of the atom <em>jl</em> and the band <span class="math">\(\nu\)</span> at
<span class="math">\(\mathbf{q}\)</span>. <span class="math">\(\mathbf{r}(jl)\)</span> is the atomic position and
<span class="math">\(\omega\)</span> is the phonon frequency. <span class="math">\(\hat{a}^\dagger\)</span> and
<span class="math">\(\hat{a}\)</span> are the creation and annihilation operators of
phonon. The expectation value of the squared atomic displacement is
calculated as,</p>
<div class="math">
\[\left\langle |u^\alpha(jl, t)|^2 \right\rangle = \frac{\hbar}{2Nm_j}
\sum_{\mathbf{q},\nu}\omega_\nu(\mathbf{q})^{-1}
(1+2n_\nu(\mathbf{q},T))|e^\alpha_\nu(j,\mathbf{q})|^2,\]</div>
<p>where <span class="math">\(n_\nu(\mathbf{q},T)\)</span> is the phonon population, which is give by,</p>
<div class="math">
\[n_\nu(\mathbf{q},T) =
\frac{1}{\exp(\hbar\omega_\nu(\mathbf{q})/\mathrm{k_B}T)-1},\]</div>
<p>where <em>T</em> is the temperature, and <span class="math">\(\mathrm{k_B}\)</span> is the
Boltzmann constant. The equation is calculated using the commutation
relation of the creation and annihilation operators and the
expectation values of the combination of the operations, e.g.,</p>
<div class="math">
\[\begin{split}[ \hat{a}_\nu(\mathbf{q}), \hat{a}^\dagger_{\nu'}(\mathbf{q'}) ]
&amp;= \delta(\mathbf{q}-\mathbf{q}')\delta_{\nu\nu'},\\
[ \hat{a}_\nu(\mathbf{q}), \hat{a}_{\nu'}(\mathbf{q'}) ] &amp;= 0,\\
[ \hat{a}^\dagger_\nu(\mathbf{q}), \hat{a}^\dagger_{\nu'}(\mathbf{q'}) ] &amp;= 0,\\
\langle|\hat{a}_\nu(\mathbf{q})\hat{a}_{\nu'}(\mathbf{q'})|\rangle &amp;= 0,\\
\langle|\hat{a}^\dagger_\nu(\mathbf{q})\hat{a}^\dagger_{\nu'}(\mathbf{q'})|\rangle
&amp;= 0.\end{split}\]</div>
</div>
<div class="section" id="mean-square-displacement-matrix">
<span id="thermal-displacement-matrix"></span><h1>Mean square displacement matrix<a class="headerlink" href="#mean-square-displacement-matrix" title="Permalink to this headline">¶</a></h1>
<p>Mean square displacement matrix is defined as follows:</p>
<div class="math">
\[\mathrm{U}_\text{cart}(j, T) = \frac{\hbar}{2Nm_j}
\sum_{\mathbf{q},\nu}\omega_\nu(\mathbf{q},T)^{-1}
(1+2n_\nu(\mathbf{q}))
\mathbf{e}_\nu(j,\mathbf{q}) \otimes \mathbf{e}^*_\nu(j,\mathbf{q}).\]</div>
<p>This is a symmetry matrix and diagonal elements are same as mean
square displacement calculated along Cartesian x, y, z directions.</p>
</div>
<div class="section" id="projection-to-an-arbitrary-axis-from-the-cartesian-axes">
<h1>Projection to an arbitrary axis from the Cartesian axes<a class="headerlink" href="#projection-to-an-arbitrary-axis-from-the-cartesian-axes" title="Permalink to this headline">¶</a></h1>
<p>In phonopy, eigenvectors are calculated in the Cartesian axes that are
defined in the input structure file. Mean square displacement along an
arbitrary axis is obtained projecting eigenvectors in the Cartesian
axes as follows:</p>
<div class="math">
\[\left\langle |u(jl, t)|^2 \right\rangle = \frac{\hbar}{2Nm_j}
\sum_{\mathbf{q},\nu}\omega_\nu(\mathbf{q})^{-1}
(1+2n_\nu(\mathbf{q}))|
\hat{\mathbf{n}}\cdot\mathbf{e}_\nu(j,\mathbf{q})|^2\]</div>
<p>where <span class="math">\(\hat{\mathbf{n}}\)</span> is an arbitrary unit direction.</p>
</div>
<div class="section" id="mean-square-displacement-matrix-in-cif-format">
<h1>Mean square displacement matrix in cif format<a class="headerlink" href="#mean-square-displacement-matrix-in-cif-format" title="Permalink to this headline">¶</a></h1>
<p>According to the paper by Grosse-Kunstleve and Adams [J. Appl. Cryst.,
35, 477-480 (2002)], mean square displacement matrix in the cif
definition (<code class="docutils literal"><span class="pre">aniso_U</span></code>),
<span class="math">\(\mathrm{U}_\text{cif}\)</span>, is obtained by</p>
<div class="math">
\[\mathrm{U}_\text{cif} = (\mathrm{AN})^{-1}\mathrm{U}_\text{cart}
(\mathrm{AN})^{-\mathrm{T}},\]</div>
<p>where <span class="math">\(\mathrm{A}\)</span> is the matrix to transform a point in fractional
coordinates to the Cartesian coordinates and <span class="math">\(\mathrm{N}\)</span> is the
diagonal matrix made of reciprocal basis vector lengths as follows:</p>
<div class="math">
\[\begin{split}\mathrm{A} = \begin{pmatrix}
a_x &amp; b_x &amp; c_x \\
a_y &amp; b_y &amp; c_y \\
a_z &amp; b_z &amp; c_z
\end{pmatrix}\end{split}\]</div>
<p>and</p>
<div class="math">
\[\begin{split}\mathrm{N} = \begin{pmatrix}
a^* &amp; 0 &amp; 0 \\
0 &amp; b^* &amp; 0 \\
0 &amp; 0 &amp; c^*
\end{pmatrix}.\end{split}\]</div>
<p><span class="math">\(a^*\)</span>, <span class="math">\(b^*\)</span>, <span class="math">\(c^*\)</span> are defined without <span class="math">\(2\pi\)</span>.</p>
</div>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
        <br/>
        
<div id="sourcelink">
  <a href="_sources/thermal-displacement.rst.txt"
     rel="nofollow">Source</a>
</div>
      
    </p>
    <p>
        &copy; Copyright 2009, Atsushi Togo.<br/>
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.6.2.<br/>
    </p>
  </div>
</footer>
  </body>
</html>