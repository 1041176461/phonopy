<!DOCTYPE html>


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Using phonopy as a python module &mdash; Phonopy v.1.10.2</title>
    
    <link rel="stylesheet" href="_static/basic.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/bootswatch-3.3.4/cosmo/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" href="_static/bootstrap-sphinx.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '1.10.2',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="_static/bootstrap-3.3.4/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="_static/bootstrap-sphinx.js"></script>
    <link rel="top" title="Phonopy v.1.10.2" href="index.html" />
    <link rel="up" title="Interfaces to calculators and phonopy API" href="interfaces.html" />
    <link rel="next" title="Auxiliary tools" href="auxiliary-tools.html" />
    <link rel="prev" title="FHI-aims &amp; phonopy calculations" href="FHI-aims.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">

  </head>
  <body role="document">

  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="index.html">
          Phonopy</a>
        <span class="navbar-text navbar-version pull-left"><b>1.10.2</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="index.html">Site <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><ul class="current">
<li class="toctree-l1"><a class="reference internal" href="examples.html">Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="procedure.html">Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="workflow.html">Work flow</a></li>
<li class="toctree-l1"><a class="reference internal" href="install.html">Download and install</a></li>
<li class="toctree-l1"><a class="reference internal" href="features.html">Features</a></li>
<li class="toctree-l1"><a class="reference internal" href="input-files.html">Input files</a></li>
<li class="toctree-l1"><a class="reference internal" href="output-files.html">Output files</a></li>
<li class="toctree-l1"><a class="reference internal" href="setting-tags.html">Setting tags</a></li>
<li class="toctree-l1"><a class="reference internal" href="command-options.html">Command options</a></li>
<li class="toctree-l1"><a class="reference internal" href="qha.html">Quasi harmonic approximation</a></li>
<li class="toctree-l1"><a class="reference internal" href="gruneisen.html">Mode Grüneisen parameters</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="interfaces.html">Interfaces to calculators and phonopy API</a></li>
<li class="toctree-l1"><a class="reference internal" href="auxiliary-tools.html">Auxiliary tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="external-tools.html">External tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="theory.html">Formulations</a></li>
<li class="toctree-l1"><a class="reference internal" href="citation.html">How to cite phonopy</a></li>
<li class="toctree-l1"><a class="reference internal" href="reference.html">References</a></li>
<li class="toctree-l1"><a class="reference internal" href="changelog.html">Change Log</a></li>
</ul>
</ul>
</li>
              
                <li class="dropdown">
  <a role="button"
     id="dLabelLocalToc"
     data-toggle="dropdown"
     data-target="#"
     href="#">Page <b class="caret"></b></a>
  <ul class="dropdown-menu localtoc"
      role="menu"
      aria-labelledby="dLabelLocalToc"><ul>
<li><a class="reference internal" href="#">Using phonopy as a python module</a><ul>
<li><a class="reference internal" href="#import">Import</a></li>
<li><a class="reference internal" href="#work-flow">Work flow</a><ul>
<li><a class="reference internal" href="#pre-process">Pre-process</a></li>
<li><a class="reference internal" href="#force-calculation">Force calculation</a></li>
<li><a class="reference internal" href="#post-process">Post process</a><ul>
<li><a class="reference internal" href="#band-structure">Band structure</a></li>
<li><a class="reference internal" href="#mesh-sampling">Mesh sampling</a></li>
<li><a class="reference internal" href="#dos-and-pdos">DOS and PDOS</a></li>
<li><a class="reference internal" href="#thermal-properties">Thermal properties</a></li>
<li><a class="reference internal" href="#non-analytical-term-correction">Non-analytical term correction</a></li>
<li><a class="reference internal" href="#group-velocity">Group velocity</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#eigenvectors">Eigenvectors</a><ul>
<li><a class="reference internal" href="#id1">Band structure</a></li>
<li><a class="reference internal" href="#id2">Mesh sampling</a></li>
</ul>
</li>
<li><a class="reference internal" href="#atoms-class-in-phonopy"><code class="docutils literal"><span class="pre">Atoms</span></code> class in Phonopy</a><ul>
<li><a class="reference internal" href="#variables">Variables</a><ul>
<li><a class="reference internal" href="#lattice-vectors"><code class="docutils literal"><span class="pre">lattice_vectors</span></code></a></li>
<li><a class="reference internal" href="#scaled-positions"><code class="docutils literal"><span class="pre">scaled_positions</span></code></a></li>
<li><a class="reference internal" href="#positions"><code class="docutils literal"><span class="pre">positions</span></code></a></li>
<li><a class="reference internal" href="#symbols"><code class="docutils literal"><span class="pre">symbols</span></code></a></li>
<li><a class="reference internal" href="#numbers"><code class="docutils literal"><span class="pre">numbers</span></code></a></li>
<li><a class="reference internal" href="#masses"><code class="docutils literal"><span class="pre">masses</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#methods">Methods</a></li>
</ul>
</li>
<li><a class="reference internal" href="#definitions-of-variables">Definitions of variables</a><ul>
<li><a class="reference internal" href="#primitive-matrix">Primitive matrix</a></li>
<li><a class="reference internal" href="#supercell-matrix">Supercell matrix</a></li>
<li><a class="reference internal" href="#symmetry-search-tolerance">Symmetry search tolerance</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</ul>
</li>
              
            
            
              
                
  <li>
    <a href="FHI-aims.html" title="Previous Chapter: FHI-aims & phonopy calculations"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm hidden-tablet">&laquo; FHI-aims & ph...</span>
    </a>
  </li>
  <li>
    <a href="auxiliary-tools.html" title="Next Chapter: Auxiliary tools"><span class="glyphicon glyphicon-chevron-right visible-sm"></span><span class="hidden-sm hidden-tablet">Auxiliary tools &raquo;</span>
    </a>
  </li>
              
            
            
            
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="col-md-12 content">
      
  <div class="section" id="using-phonopy-as-a-python-module">
<span id="phonopy-module"></span><h1>Using phonopy as a python module<a class="headerlink" href="#using-phonopy-as-a-python-module" title="Permalink to this headline">¶</a></h1>
<p><strong>This is under development. Configurations may alter.</strong> Requests or
suggestions are very welcome.</p>
<div class="section" id="import">
<h2>Import<a class="headerlink" href="#import" title="Permalink to this headline">¶</a></h2>
<p>After setting the phonopy python path, you can import it by</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">phonopy</span> <span class="kn">import</span> <span class="n">Phonopy</span>
</pre></div>
</div>
<p>The phonopy <code class="docutils literal"><span class="pre">Atoms</span></code> class is imported by</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">phonopy.structure.atoms</span> <span class="kn">import</span> <span class="n">Atoms</span> <span class="k">as</span> <span class="n">PhonopyAtoms</span>
</pre></div>
</div>
<p>See the examples in the <code class="docutils literal"><span class="pre">example/ase</span></code> directory in the phonopy
distribution package.</p>
</div>
<div class="section" id="work-flow">
<h2>Work flow<a class="headerlink" href="#work-flow" title="Permalink to this headline">¶</a></h2>
<p>The work flow is schematically shown in <a class="reference internal" href="workflow.html#workflow"><span>Work flow</span></a>.</p>
<div class="section" id="pre-process">
<h3>Pre-process<a class="headerlink" href="#pre-process" title="Permalink to this headline">¶</a></h3>
<p>Import <code class="docutils literal"><span class="pre">phonopy</span></code> and create Phonopy object with</p>
<ul class="simple">
<li>unit cell (<code class="docutils literal"><span class="pre">Atoms</span></code> object, see <a class="reference internal" href="#phonopy-atoms"><span>Atoms class in Phonopy</span></a>)</li>
<li>supercell matrix (3x3 array, see <a class="reference internal" href="#variable-supercell-matrix"><span>Supercell matrix</span></a>)</li>
</ul>
<div class="highlight-python"><div class="highlight"><pre><span class="n">a</span> <span class="o">=</span> <span class="mf">5.404</span>
<span class="n">bulk</span> <span class="o">=</span> <span class="n">PhonopyAtoms</span><span class="p">(</span><span class="n">symbols</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Si&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="mi">8</span><span class="p">,</span>
                    <span class="n">scaled_positions</span><span class="o">=</span><span class="p">[(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
                                      <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">),</span>
                                      <span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">),</span>
                                      <span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
                                      <span class="p">(</span><span class="mf">0.25</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">),</span>
                                      <span class="p">(</span><span class="mf">0.25</span><span class="p">,</span> <span class="mf">0.75</span><span class="p">,</span> <span class="mf">0.75</span><span class="p">),</span>
                                      <span class="p">(</span><span class="mf">0.75</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">,</span> <span class="mf">0.75</span><span class="p">),</span>
                                      <span class="p">(</span><span class="mf">0.75</span><span class="p">,</span> <span class="mf">0.75</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">)]</span> <span class="p">)</span>
<span class="n">bulk</span><span class="o">.</span><span class="n">set_cell</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">((</span><span class="n">a</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">a</span><span class="p">)))</span>
<span class="n">phonon</span> <span class="o">=</span> <span class="n">Phonopy</span><span class="p">(</span><span class="n">bulk</span><span class="p">,</span>
                 <span class="p">[[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]],</span>
                 <span class="n">primitive_matrix</span><span class="o">=</span><span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">],</span>
                                   <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">],</span>
                                   <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mi">0</span><span class="p">]],</span>
                 <span class="n">distance</span><span class="o">=</span><span class="mf">0.01</span><span class="p">)</span>
</pre></div>
</div>
<p>Obtain supercells containing respective displacements by
<code class="docutils literal"><span class="pre">get_supercells_with_displacements</span></code>, which are given by a list of
<code class="docutils literal"><span class="pre">Atoms</span></code> objects.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">supercells</span> <span class="o">=</span> <span class="n">phonon</span><span class="o">.</span><span class="n">get_supercells_with_displacements</span><span class="p">()</span>
</pre></div>
</div>
<p>The information of this class object is found at the bottoem of this
page.</p>
<p>In general case, unit conversion factor for phonon frequency has to be
set by using the <code class="docutils literal"><span class="pre">factor</span></code> keyword. The factor from the VASP unit to
THz is the default value of <code class="docutils literal"><span class="pre">factor</span></code>. Some of the physical unit
conversion factors may be found in <code class="docutils literal"><span class="pre">phonopy/units.py</span></code>. More about
the conversion factor is written <a class="reference internal" href="command-options.html#unit-conversion-factor-option"><span>here</span></a>.</p>
</div>
<div class="section" id="force-calculation">
<h3>Force calculation<a class="headerlink" href="#force-calculation" title="Permalink to this headline">¶</a></h3>
<p>Run force calculations for the supercells.
Then collect forces from the calculation results. The sets of forces
has to be given in nested list (<code class="docutils literal"><span class="pre">sets_of_forces</span></code>) as:</p>
<div class="highlight-python"><div class="highlight"><pre>[ [ [ f_1x, f_1y, f_1z ], [ f_2x, f_2y, f_2z ], ... ], # first supercell
  [ [ f_1x, f_1y, f_1z ], [ f_2x, f_2y, f_2z ], ... ], # second supercell
  ...                                                   ]
</pre></div>
</div>
<p>This is the case when the set of atomic displacements is generated
internally. The information of displacements is already stored in
phonopy object. But if you want to input forces together with the
corresponding set of displacements, <code class="docutils literal"><span class="pre">displacement_dataset</span></code> has to be
prepared as a python dictionary as follows:</p>
<div class="highlight-python"><div class="highlight"><pre>displacement_dataset:
   {&#39;natom&#39;: number_of_atoms_in_supercell,
    &#39;first_atoms&#39;: [
      {&#39;number&#39;: atom index of displaced atom,
       &#39;displacement&#39;: displacement in Cartesian coordinates,
       &#39;forces&#39;: forces on atoms in supercell},
      {...}, ...]}
</pre></div>
</div>
<p><code class="docutils literal"><span class="pre">first_atoms</span></code> is just a list to contain a set of displacements and
corresponding forces. Then this is set by</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">phonopy</span><span class="o">.</span><span class="n">set_displacement_dataset</span><span class="p">(</span><span class="n">displacement_dataset</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="post-process">
<h3>Post process<a class="headerlink" href="#post-process" title="Permalink to this headline">¶</a></h3>
<p>Prepare force constants internally with calculated suuprcell sets of
forces by</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">phonon</span><span class="o">.</span><span class="n">set_forces</span><span class="p">(</span><span class="n">sets_of_forces</span><span class="p">)</span>
<span class="n">phonon</span><span class="o">.</span><span class="n">produce_force_constants</span><span class="p">()</span>
</pre></div>
</div>
<p>If you have force constants and don&#8217;t need to create force constants
from forces and displacements, simply set your force constants by</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">phonon</span><span class="o">.</span><span class="n">set_force_constants</span><span class="p">(</span><span class="n">force_constants</span><span class="p">)</span>
</pre></div>
</div>
<p>The force constants matrix is given in 4 dimensional array
(better to be a numpy array of <code class="docutils literal"><span class="pre">dtype='double',</span> <span class="pre">order='C'</span></code>).
The shape of force constants matrix is <code class="docutils literal"><span class="pre">(N,</span> <span class="pre">N,</span> <span class="pre">3,</span> <span class="pre">3)</span></code> where <code class="docutils literal"><span class="pre">N</span></code>
is the number of atoms in the supercell and 3 gives Cartesian axes.</p>
<div class="section" id="band-structure">
<h4>Band structure<a class="headerlink" href="#band-structure" title="Permalink to this headline">¶</a></h4>
<p>Set band paths (<code class="docutils literal"><span class="pre">set_band_structure</span></code>) and get the results
(<code class="docutils literal"><span class="pre">get_band_structure</span></code>).</p>
<p>A tuple of (q-points, distances, frequencies, eigenvectors) is
obtained by <code class="docutils literal"><span class="pre">get_band_structure()</span></code>. Eigenvectors can be obtained
when <code class="docutils literal"><span class="pre">is_eigenvectors=True</span></code> at <code class="docutils literal"><span class="pre">set_band_structure()</span></code>. Eigenvalues
are stored in a numpy array with the shape of (number_of_bands,
len(distances)).  Phonon frequency is sqrt(eigenvalue). A negative
eigenvalue has to correspond to the imaginary frequency, but for the
plotting, it is set as the negative value in the above example. In
addition, you need to multiply by your unit conversion factor. In the
case of VASP to transform to THz, the factor is 15.633302.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">bands</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">q_start</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">])</span>
<span class="n">q_end</span>    <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">])</span>
<span class="n">band</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">51</span><span class="p">):</span>
    <span class="n">band</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">q_start</span> <span class="o">+</span> <span class="p">(</span><span class="n">q_end</span> <span class="o">-</span> <span class="n">q_start</span><span class="p">)</span> <span class="o">/</span> <span class="mi">50</span> <span class="o">*</span> <span class="n">i</span><span class="p">)</span>
<span class="n">bands</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">band</span><span class="p">)</span>

<span class="n">q_start</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">])</span>
<span class="n">q_end</span>    <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">])</span>
<span class="n">band</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">51</span><span class="p">):</span>
    <span class="n">band</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">q_start</span> <span class="o">+</span> <span class="p">(</span><span class="n">q_end</span> <span class="o">-</span> <span class="n">q_start</span><span class="p">)</span> <span class="o">/</span> <span class="mi">50</span> <span class="o">*</span> <span class="n">i</span><span class="p">)</span>
<span class="n">bands</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">band</span><span class="p">)</span>

<span class="n">phonon</span><span class="o">.</span><span class="n">set_band_structure</span><span class="p">(</span><span class="n">bands</span><span class="p">)</span>
<span class="n">phonon</span><span class="o">.</span><span class="n">plot_band_structure</span><span class="p">()</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="n">q_points</span><span class="p">,</span> <span class="n">distances</span><span class="p">,</span> <span class="n">frequencies</span><span class="p">,</span> <span class="n">eigvecs</span> <span class="o">=</span> <span class="n">phonon</span><span class="o">.</span><span class="n">get_band_structure</span><span class="p">()</span>
</pre></div>
</div>
<p>To obtain eigenvectors, it is necessary to inform to store
eigenvectors by:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">phonon</span><span class="o">.</span><span class="n">set_band_structure</span><span class="p">(</span><span class="n">bands</span><span class="p">,</span> <span class="n">is_eigenvectors</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="mesh-sampling">
<h4>Mesh sampling<a class="headerlink" href="#mesh-sampling" title="Permalink to this headline">¶</a></h4>
<p>Set sampling mesh (<code class="docutils literal"><span class="pre">set_mesh</span></code>) in reciprocal space. The irreducible
<em>q</em>-points and corresponding <em>q</em>-point weights, eigenvalues, and
eigenvectors are obtained by <code class="docutils literal"><span class="pre">get_mesh</span></code>.  <code class="docutils literal"><span class="pre">mesh</span></code> gives the
sampling mesh with Monkhorst-Pack scheme. The keyword <code class="docutils literal"><span class="pre">shift</span></code> gives
the fractional mesh shift with respect to the neighboring grid points.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">mesh</span> <span class="o">=</span> <span class="p">[</span><span class="mi">20</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">20</span><span class="p">]</span>
<span class="n">phonon</span><span class="o">.</span><span class="n">set_mesh</span><span class="p">(</span><span class="n">mesh</span><span class="p">)</span>
<span class="n">qpoints</span><span class="p">,</span> <span class="n">weights</span><span class="p">,</span> <span class="n">frequencies</span><span class="p">,</span> <span class="n">eigvecs</span> <span class="o">=</span> <span class="n">phonon</span><span class="o">.</span><span class="n">get_mesh</span><span class="p">()</span>
</pre></div>
</div>
<p>To obtain eigenvectors, it is necessary to inform to store
eigenvectors by:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">phonon</span><span class="o">.</span><span class="n">set_mesh</span><span class="p">([</span><span class="mi">20</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">20</span><span class="p">],</span> <span class="n">is_eigenvectors</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="dos-and-pdos">
<h4>DOS and PDOS<a class="headerlink" href="#dos-and-pdos" title="Permalink to this headline">¶</a></h4>
<p>Before starting mesh sampling has to be finished. Then set parameters
(<code class="docutils literal"><span class="pre">set_total_DOS</span></code> or <code class="docutils literal"><span class="pre">set_partial_DOS</span></code>) and write the results into
files (<code class="docutils literal"><span class="pre">write_total_DOS</span></code> and <code class="docutils literal"><span class="pre">write_partial_DOS</span></code>). In the case of
PDOS, the eigenvectors have to be calculated in the mesh
sampling. <code class="docutils literal"><span class="pre">get_total_DOS</span></code> and <code class="docutils literal"><span class="pre">get_partial_DOS</span></code> are under preparation.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">phonon</span><span class="o">.</span><span class="n">set_total_DOS</span><span class="p">()</span>
<span class="n">phonon</span><span class="o">.</span><span class="n">plot_total_DOS</span><span class="p">()</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="section" id="thermal-properties">
<h4>Thermal properties<a class="headerlink" href="#thermal-properties" title="Permalink to this headline">¶</a></h4>
<p>Before starting the thermal property calculation, the mesh sampling
calclation has to be done in the <strong>THz unit</strong>. The unit conversion
factor for phonon frequency is set in the pre-process of Phonopy with
the <code class="docutils literal"><span class="pre">factor</span></code> keyword. Calculation range of temperature is set by the
parameters <code class="docutils literal"><span class="pre">set_thermal_properties</span></code>. Helmholtz free energy, entropy,
heat capacity at contant volume at temperaturs are obtained by
<code class="docutils literal"><span class="pre">get_thermal_properties</span></code>, where the results are given as a tuple of
temperaturs, Helmholtz free energy, entropy, and heat capacity.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">phonon</span><span class="o">.</span><span class="n">set_thermal_properties</span><span class="p">(</span><span class="n">t_step</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
                              <span class="n">t_max</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span>
                              <span class="n">t_min</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="k">for</span> <span class="n">t</span><span class="p">,</span> <span class="n">free_energy</span><span class="p">,</span> <span class="n">entropy</span><span class="p">,</span> <span class="n">cv</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">phonon</span><span class="o">.</span><span class="n">get_thermal_properties</span><span class="p">())</span><span class="o">.</span><span class="n">T</span><span class="p">:</span>
    <span class="k">print</span> <span class="p">(</span><span class="s2">&quot;</span><span class="si">%12.3f</span><span class="s2"> &quot;</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="si">%15.7f</span><span class="s2">&quot;</span> <span class="o">*</span> <span class="mi">3</span><span class="p">)</span> <span class="o">%</span> <span class="p">(</span> <span class="n">t</span><span class="p">,</span> <span class="n">free_energy</span><span class="p">,</span> <span class="n">entropy</span><span class="p">,</span> <span class="n">cv</span> <span class="p">)</span>

<span class="n">phonon</span><span class="o">.</span><span class="n">plot_thermal_properties</span><span class="p">()</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="section" id="non-analytical-term-correction">
<h4>Non-analytical term correction<a class="headerlink" href="#non-analytical-term-correction" title="Permalink to this headline">¶</a></h4>
<p>To apply non-analytical term correction, Born effective charge tensors
for all atoms in <strong>primitive</strong> cell, dielectric constant tensor, and
the unit conversion factor have to be correctly set. The tensors are
given in Cartesian coordinates.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">born</span> <span class="o">=</span> <span class="p">[[[</span><span class="mf">1.08703</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
         <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mf">1.08703</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
         <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">1.08703</span><span class="p">]],</span>
        <span class="p">[[</span><span class="o">-</span><span class="mf">1.08672</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
         <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.08672</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
         <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.08672</span><span class="p">]]]</span>
<span class="n">epsilon</span> <span class="o">=</span> <span class="p">[[</span><span class="mf">2.43533967</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
           <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mf">2.43533967</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
           <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">2.43533967</span><span class="p">]]</span>
<span class="n">factors</span> <span class="o">=</span> <span class="mf">14.400</span>
<span class="n">phonon</span><span class="o">.</span><span class="n">set_nac_params</span><span class="p">({</span><span class="s1">&#39;born&#39;</span><span class="p">:</span> <span class="n">born</span><span class="p">,</span>
                       <span class="s1">&#39;factor&#39;</span><span class="p">:</span> <span class="n">factors</span><span class="p">,</span>
                       <span class="s1">&#39;dielectric&#39;</span><span class="p">:</span> <span class="n">epsilon</span><span class="p">})</span>
</pre></div>
</div>
</div>
<div class="section" id="group-velocity">
<span id="phonopy-eigenvectors"></span><h4>Group velocity<a class="headerlink" href="#group-velocity" title="Permalink to this headline">¶</a></h4>
<p>A group velocity at a q-point is obtained by:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">phonon</span><span class="o">.</span><span class="n">get_group_velocity_at_q</span><span class="p">(</span><span class="n">q_point</span><span class="p">)</span>
</pre></div>
</div>
<p>Group velocities with mesh sampling, band structure, or q-points
calculations are given as follows.</p>
<p>First inform phonopy object to calculate group velocity:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">phonon</span><span class="o">.</span><span class="n">set_group_velocity</span><span class="p">()</span>
</pre></div>
</div>
<p>Then the respective group velocities are obtained by:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">phonon</span><span class="o">.</span><span class="n">get_group_velocity</span><span class="p">()</span>
</pre></div>
</div>
<p>The shape of group velocity array is to follow those array shapes of
calculation modes.</p>
</div>
</div>
</div>
<div class="section" id="eigenvectors">
<h2>Eigenvectors<a class="headerlink" href="#eigenvectors" title="Permalink to this headline">¶</a></h2>
<p>Eigenvectors are given as the column vectors. Internally phonopy uses
numpy.linalg.eigh and eigh is a wrapper of LAPACK. So eigenvectors
follow the convention of LAPACK, which can be shown at
<a class="reference external" href="http://docs.scipy.org/doc/numpy/reference/generated/numpy.linalg.eigh.html">http://docs.scipy.org/doc/numpy/reference/generated/numpy.linalg.eigh.html</a></p>
<p>Eigenvectors corresponding to phonopy yaml output are obtained as follows.</p>
<div class="section" id="id1">
<h3>Band structure<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h3>
<div class="highlight-python"><div class="highlight"><pre><span class="k">if</span> <span class="n">eigvecs</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">eigvecs_on_path</span> <span class="ow">in</span> <span class="n">eigvecs</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">eigvecs_at_q</span> <span class="ow">in</span> <span class="n">eigvecs_on_path</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">vec</span> <span class="ow">in</span> <span class="n">eigvecs_at_q</span><span class="o">.</span><span class="n">T</span><span class="p">:</span>
                <span class="k">print</span> <span class="n">vec</span>
</pre></div>
</div>
</div>
<div class="section" id="id2">
<h3>Mesh sampling<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h3>
<div class="highlight-python"><div class="highlight"><pre><span class="k">if</span> <span class="n">eigvecs</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">eigvecs_at_q</span> <span class="ow">in</span> <span class="n">eigvecs</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">vec</span> <span class="ow">in</span> <span class="n">eigvecs_at_q</span><span class="o">.</span><span class="n">T</span><span class="p">:</span>
            <span class="k">print</span> <span class="n">vec</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="atoms-class-in-phonopy">
<span id="phonopy-atoms"></span><h2><code class="docutils literal"><span class="pre">Atoms</span></code> class in Phonopy<a class="headerlink" href="#atoms-class-in-phonopy" title="Permalink to this headline">¶</a></h2>
<div class="section" id="variables">
<span id="phonopy-atoms-variables"></span><h3>Variables<a class="headerlink" href="#variables" title="Permalink to this headline">¶</a></h3>
<p>The following variables are implemented in the <code class="docutils literal"><span class="pre">Atoms</span></code> class of
Phonopy in <code class="docutils literal"><span class="pre">atoms.py</span></code>.</p>
<div class="section" id="lattice-vectors">
<span id="phonopy-atoms-cell"></span><h4><code class="docutils literal"><span class="pre">lattice_vectors</span></code><a class="headerlink" href="#lattice-vectors" title="Permalink to this headline">¶</a></h4>
<p>Lattice vectors are given in the matrix form in Cartesian coordinates.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="p">[</span> <span class="p">[</span> <span class="n">a_x</span><span class="p">,</span> <span class="n">a_y</span><span class="p">,</span> <span class="n">a_z</span> <span class="p">],</span>
  <span class="p">[</span> <span class="n">b_x</span><span class="p">,</span> <span class="n">b_y</span><span class="p">,</span> <span class="n">b_z</span> <span class="p">],</span>
  <span class="p">[</span> <span class="n">c_x</span><span class="p">,</span> <span class="n">c_y</span><span class="p">,</span> <span class="n">c_z</span> <span class="p">]</span> <span class="p">]</span>
</pre></div>
</div>
</div>
<div class="section" id="scaled-positions">
<h4><code class="docutils literal"><span class="pre">scaled_positions</span></code><a class="headerlink" href="#scaled-positions" title="Permalink to this headline">¶</a></h4>
<p>Atomic positions in fractional coordinates.</p>
<div class="highlight-python"><div class="highlight"><pre>[ [ x1_a, x1_b, x1_c ],
  [ x2_a, x2_b, x2_c ],
  [ x3_a, x3_b, x3_c ],
  ...                   ]
</pre></div>
</div>
</div>
<div class="section" id="positions">
<h4><code class="docutils literal"><span class="pre">positions</span></code><a class="headerlink" href="#positions" title="Permalink to this headline">¶</a></h4>
<p>Cartesian positions of atoms.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">positions</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span> <span class="n">scaled_positions</span><span class="p">,</span> <span class="n">lattice_vectors</span> <span class="p">)</span>
</pre></div>
</div>
<p>where <code class="docutils literal"><span class="pre">np</span></code> means the numpy module (<code class="docutils literal"><span class="pre">import</span> <span class="pre">numpy</span> <span class="pre">as</span> <span class="pre">np</span></code>).</p>
</div>
<div class="section" id="symbols">
<h4><code class="docutils literal"><span class="pre">symbols</span></code><a class="headerlink" href="#symbols" title="Permalink to this headline">¶</a></h4>
<p>Chemical symbols, e.g.,</p>
<div class="highlight-python"><div class="highlight"><pre><span class="p">[</span> <span class="n">Zn</span><span class="p">,</span> <span class="n">Zn</span><span class="p">,</span> <span class="n">O</span><span class="p">,</span> <span class="n">O</span> <span class="p">]</span>
</pre></div>
</div>
<p>for the ZnO unit cell.</p>
</div>
<div class="section" id="numbers">
<h4><code class="docutils literal"><span class="pre">numbers</span></code><a class="headerlink" href="#numbers" title="Permalink to this headline">¶</a></h4>
<p>Atomic numbers, e.g.,</p>
<div class="highlight-python"><div class="highlight"><pre><span class="p">[</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">8</span> <span class="p">]</span>
</pre></div>
</div>
<p>for the ZnO unit cell.</p>
</div>
<div class="section" id="masses">
<h4><code class="docutils literal"><span class="pre">masses</span></code><a class="headerlink" href="#masses" title="Permalink to this headline">¶</a></h4>
<p>Atomic masses, e.g.,</p>
<div class="highlight-python"><div class="highlight"><pre><span class="p">[</span> <span class="mf">65.38</span><span class="p">,</span> <span class="mf">65.38</span><span class="p">,</span> <span class="mf">15.9994</span><span class="p">,</span> <span class="mf">15.9994</span> <span class="p">]</span>
</pre></div>
</div>
<p>for the ZnO unit cell.</p>
</div>
</div>
<div class="section" id="methods">
<h3>Methods<a class="headerlink" href="#methods" title="Permalink to this headline">¶</a></h3>
<div class="highlight-python"><div class="highlight"><pre><span class="n">set_cell</span><span class="p">(</span> <span class="n">lattice_vectors</span> <span class="p">)</span>
<span class="n">get_cell</span><span class="p">()</span>
<span class="n">set_positions</span><span class="p">(</span> <span class="n">positions</span> <span class="p">)</span>
<span class="n">get_positions</span><span class="p">()</span>
<span class="n">set_scaled_positions</span><span class="p">(</span> <span class="n">scaled_positions</span> <span class="p">)</span>
<span class="n">get_scaled_positions</span><span class="p">()</span>
<span class="n">set_masses</span><span class="p">(</span> <span class="n">masses</span> <span class="p">)</span>
<span class="n">get_masses</span><span class="p">()</span>
<span class="n">set_chemical_symbols</span><span class="p">(</span> <span class="n">symbols</span> <span class="p">)</span>
<span class="n">get_chemical_symbols</span><span class="p">()</span>
<span class="n">get_number_of_atoms</span><span class="p">()</span>
<span class="n">get_atomic_numbers</span><span class="p">()</span>
<span class="n">get_volume</span><span class="p">()</span>
</pre></div>
</div>
<p>These methods are compatible to the ASE&#8217;s <code class="docutils literal"><span class="pre">Atoms</span></code>
class. The arguments have to be set in the structures shown in
<a class="reference internal" href="#phonopy-atoms-variables"><span>Variables</span></a>.</p>
<p>The usable keywords in the initialization are:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">symbols</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
<span class="n">positions</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
<span class="n">numbers</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
<span class="n">masses</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
<span class="n">scaled_positions</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
<span class="n">cell</span><span class="o">=</span><span class="bp">None</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="definitions-of-variables">
<h2>Definitions of variables<a class="headerlink" href="#definitions-of-variables" title="Permalink to this headline">¶</a></h2>
<div class="section" id="primitive-matrix">
<span id="variable-primitive-matrix"></span><h3>Primitive matrix<a class="headerlink" href="#primitive-matrix" title="Permalink to this headline">¶</a></h3>
<p>Primitive matrix <img class="math" src="_images/math/ed5eb22a8204dd3e7e6237395da7ec7597f29649.png" alt="M_\mathrm{p}"/> is a tranformation matrix from
lattice vectors to those of a primitive cell if there exists the
primitive cell in the lattice vectors. Following a crystallography
convention, the transformation is given by</p>
<div class="math">
<p><img src="_images/math/9e2ab2bc1851f811baa382d5e4d3fac45e956bcb.png" alt="( \mathbf{a}_\mathrm{p} \; \mathbf{b}_\mathrm{p} \; \mathbf{c}_\mathrm{p} )
=  ( \mathbf{a}_\mathrm{u} \; \mathbf{b}_\mathrm{u} \;
\mathbf{c}_\mathrm{u} ) M_\mathrm{p}"/></p>
</div><p>where <img class="math" src="_images/math/b3da4e758165f6ef26ea31cd90aa4bb2fbd57852.png" alt="\mathbf{a}_\mathrm{u}"/>, <img class="math" src="_images/math/1413ad461b1aa17d57bf4c458a1f286643e5e50f.png" alt="\mathbf{b}_\mathrm{u}"/>,
and <img class="math" src="_images/math/a0273596f3e79f38512ca0a60f69cc7a99a8f43f.png" alt="\mathbf{c}_\mathrm{u}"/> are the column vectors of the
original lattice vectors, and <img class="math" src="_images/math/5954dc42d29df3a300246e8f86ff6f2b8a276abf.png" alt="\mathbf{a}_\mathrm{p}"/>,
<img class="math" src="_images/math/2a11ea14b938f167771e6645622afa0832f6dd1c.png" alt="\mathbf{b}_\mathrm{p}"/>, and <img class="math" src="_images/math/a3969b8079498f063e84f8a36ef1de8cded0f198.png" alt="\mathbf{c}_\mathrm{p}"/> are
the column vectors of the primitive lattice vectors. Be careful that
the lattice vectors of the <code class="docutils literal"><span class="pre">Atoms</span></code> class are the row vectors
(<a class="reference internal" href="#phonopy-atoms-cell"><span>lattice_vectors</span></a>). Therefore the phonopy code, which relies
on the Atoms class, is usually written such as</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">primitive_lattice</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span> <span class="n">original_lattice</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">primitive_matrix</span> <span class="p">)</span><span class="o">.</span><span class="n">T</span><span class="p">,</span>
</pre></div>
</div>
<p>or equivalently,</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">primitive_lattice</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span> <span class="n">primitive_matrix</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">original_lattice</span> <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="supercell-matrix">
<span id="variable-supercell-matrix"></span><h3>Supercell matrix<a class="headerlink" href="#supercell-matrix" title="Permalink to this headline">¶</a></h3>
<p>Supercell matrix <img class="math" src="_images/math/334501cd15978f356e18bb02e2ac826bf4f61cac.png" alt="M_\mathrm{s}"/> is a tranformation matrix from
lattice vectors to those of a super cell. Following a crystallography
convention, the transformation is given by</p>
<div class="math">
<p><img src="_images/math/be4b130dee19ed41a079e1e62c2a7e36a8058134.png" alt="( \mathbf{a}_\mathrm{s} \; \mathbf{b}_\mathrm{s} \; \mathbf{c}_\mathrm{s} )
=  ( \mathbf{a}_\mathrm{u} \; \mathbf{b}_\mathrm{u} \;
\mathbf{c}_\mathrm{u} ) M_\mathrm{s}"/></p>
</div><p>where <img class="math" src="_images/math/b3da4e758165f6ef26ea31cd90aa4bb2fbd57852.png" alt="\mathbf{a}_\mathrm{u}"/>, <img class="math" src="_images/math/1413ad461b1aa17d57bf4c458a1f286643e5e50f.png" alt="\mathbf{b}_\mathrm{u}"/>,
and <img class="math" src="_images/math/a0273596f3e79f38512ca0a60f69cc7a99a8f43f.png" alt="\mathbf{c}_\mathrm{u}"/> are the column vectors of the
original lattice vectors, and <img class="math" src="_images/math/5a3081ef3ed7b99083f1dbeaac0c75f368a2fb85.png" alt="\mathbf{a}_\mathrm{s}"/>,
<img class="math" src="_images/math/a454cca58ead035bdbdfad251eda86d17a8fc5bf.png" alt="\mathbf{b}_\mathrm{s}"/>, and <img class="math" src="_images/math/0298b49b4e11950a7d7fb75b0640a25264c63428.png" alt="\mathbf{c}_\mathrm{s}"/> are
the column vectors of the supercell lattice vectors.  Be careful that
the lattice vectors of the <code class="docutils literal"><span class="pre">Atoms</span></code> class are the row vectors
(<a class="reference internal" href="#phonopy-atoms-cell"><span>lattice_vectors</span></a>). Therefore the phonopy code, which relies
on the Atoms class, is usually written such as</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">supercell_lattice</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span> <span class="n">original_lattice</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">supercell_matrix</span> <span class="p">)</span><span class="o">.</span><span class="n">T</span><span class="p">,</span>
</pre></div>
</div>
<p>or equivalently,</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">supercell_lattice</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span> <span class="n">supercell_matrix</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">original_lattice</span> <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="symmetry-search-tolerance">
<h3>Symmetry search tolerance<a class="headerlink" href="#symmetry-search-tolerance" title="Permalink to this headline">¶</a></h3>
<p>Symmetry search tolerance (often the name <code class="docutils literal"><span class="pre">symprec</span></code> is used in
phonopy) is used to determine symmetry operations of the crystal
structures. The physical unit follows that of input crystal structure.</p>
</div>
</div>
</div>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
        <br/>
        
<div id="sourcelink">
  <a href="_sources/phonopy-module.txt"
     rel="nofollow">Source</a>
</div>
      
    </p>
    <p>
        &copy; Copyright 2009, Atsushi Togo.<br/>
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.3.4.<br/>
    </p>
  </div>
</footer>
  </body>
</html>